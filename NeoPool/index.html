<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Documentation (Wiki) for Tasmota"><link href=https://tasmota.github.io/docs/NeoPool/ rel=canonical><link rel=icon href=../_media/favicon.ico><meta name=generator content="mkdocs-1.4.2, mkdocs-material-9.0.12"><title>Sugar Valley NeoPool Controller - Tasmota</title><link rel=stylesheet href=../assets/stylesheets/main.0d440cfe.min.css><link rel=stylesheet href=../assets/stylesheets/palette.2505c338.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Barlow:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Barlow";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../assets/css/anchor-fix.css><script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-8J08F8X90S"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-8J08F8X90S",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-8J08F8X90S",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=blue data-md-color-accent=indigo> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#sugar-valley-neopool-controller class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=.. title=Tasmota class="md-header__button md-logo" aria-label=Tasmota data-md-component=logo> <img src=../_media/logo.svg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Tasmota </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Sugar Valley NeoPool Controller </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=blue data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=blue data-md-color-accent=deep-purple aria-label="Switch to light mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/arendst/tasmota title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> arendst/tasmota </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../Features/ class=md-tabs__link> Features </a> </li> <li class=md-tabs__item> <a href=../ESP32/ class=md-tabs__link> ESP32 </a> </li> <li class=md-tabs__item> <a href=../Integrations/ class=md-tabs__link> Smart Home Integrations </a> </li> <li class=md-tabs__item> <a href=../Supported-Peripherals/ class=md-tabs__link> Peripherals </a> </li> <li class=md-tabs__item> <a href=../Configuration-Procedure-for-New-Devices/ class=md-tabs__link> Supported Devices </a> </li> <li class=md-tabs__item> <a href=../FAQ/ class=md-tabs__link> Help </a> </li> <li class=md-tabs__item> <a href=http://tasmota.github.io/install class=md-tabs__link> Web Installer </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=.. title=Tasmota class="md-nav__button md-logo" aria-label=Tasmota data-md-component=logo> <img src=../_media/logo.svg alt=logo> </a> Tasmota </label> <div class=md-nav__source> <a href=https://github.com/arendst/tasmota title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> arendst/tasmota </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1> <label class=md-nav__link for=__nav_1 id=__nav_1_label tabindex=0> Home <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_1_label aria-expanded=false> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> Home </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=.. class=md-nav__link> News </a> </li> <li class=md-nav__item> <a href=../About/ class=md-nav__link> About </a> </li> <li class=md-nav__item> <a href=../Getting-Started/ class=md-nav__link> Getting Started </a> </li> <li class=md-nav__item> <a href=../Upgrading/ class=md-nav__link> Upgrading </a> </li> <li class=md-nav__item> <a href=../MQTT/ class=md-nav__link> MQTT </a> </li> <li class=md-nav__item> <a href=../Commands/ class=md-nav__link> Commands </a> </li> <li class=md-nav__item> <a href=../Templates/ class=md-nav__link> Templates </a> </li> <li class=md-nav__item> <a href=../Components/ class=md-nav__link> Components </a> </li> <li class=md-nav__item> <a href=../Modules/ class=md-nav__link> Modules </a> </li> <li class=md-nav__item> <a href=../Peripherals/ class=md-nav__link> Peripherals </a> </li> <li class=md-nav__item> <a href=../WebUI/ class=md-nav__link> WebUI </a> </li> <li class=md-nav__item> <a href=../Firmware-Builds/ class=md-nav__link> Firmware Builds </a> </li> <li class=md-nav__item> <a href=../Compile-your-build/ class=md-nav__link> Compiling </a> </li> <li class=md-nav__item> <a href=../Contributing/ class=md-nav__link> Contributing </a> </li> <li class=md-nav__item> <a href=../Download/ class=md-nav__link> Download </a> </li> <li class=md-nav__item> <a href=https://github.com/arendst/Tasmota/discussions/categories/show-and-tell class=md-nav__link> Project Showcase </a> </li> <li class=md-nav__item> <a href=../For-Developers/ class=md-nav__link> For Developers </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> Features <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Features </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Features/ class=md-nav__link> Introduction </a> </li> <li class=md-nav__item> <a href=../ADC/ class=md-nav__link> Analog Pin </a> </li> <li class=md-nav__item> <a href=../ArtNet/ class=md-nav__link> ArtNet DMX </a> </li> <li class=md-nav__item> <a href=../Buttons-and-Switches/ class=md-nav__link> Buttons and Switches </a> </li> <li class=md-nav__item> <a href=../DeepSleep/ class=md-nav__link> DeepSleep </a> </li> <li class=md-nav__item> <a href=../Device-Groups/ class=md-nav__link> Device Groups </a> </li> <li class=md-nav__item> <a href=../Displays/ class=md-nav__link> Displays </a> </li> <li class=md-nav__item> <a href=../Dynamic-Sleep/ class=md-nav__link> Dynamic Sleep </a> </li> <li class=md-nav__item> <a href=../I2CDEVICES/ class=md-nav__link> I2C Devices </a> </li> <li class=md-nav__item> <a href=../IPv6/ class=md-nav__link> IPv6 </a> </li> <li class=md-nav__item> <a href=../Lights/ class=md-nav__link> Lights </a> </li> <li class=md-nav__item> <a href=../PIR-Motion-Sensors/ class=md-nav__link> PIR Motion Sensors </a> </li> <li class=md-nav__item> <a href=../Power-Monitoring-Calibration/ class=md-nav__link> Power Monitoring Calibration </a> </li> <li class=md-nav__item> <a href=../PWM-dimmer-switch/ class=md-nav__link> PWM Dimmer </a> </li> <li class=md-nav__item> <a href=../Rules/ class=md-nav__link> Rules </a> </li> <li class=md-nav__item> <a href=../Scripting-Language/ class=md-nav__link> Scripting Language </a> </li> <li class=md-nav__item> <a href=../Blinds-and-Shutters/ class=md-nav__link> Shutters and Blinds </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_18> <label class=md-nav__link for=__nav_2_18 id=__nav_2_18_label tabindex=0> Protocol Bridging <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_18_label aria-expanded=false> <label class=md-nav__title for=__nav_2_18> <span class="md-nav__icon md-icon"></span> Protocol Bridging </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../TasmotaClient/ class=md-nav__link> Arduino MCU </a> </li> <li class=md-nav__item> <a href=../Bluetooth/ class=md-nav__link> BLE Gateway </a> </li> <li class=md-nav__item> <a href=../Tasmota-IR/ class=md-nav__link> IR Communication </a> </li> <li class=md-nav__item> <a href=../Projector/ class=md-nav__link> LCD/DLP Projector Control </a> </li> <li class=md-nav__item> <a href=../Modbus-Bridge/ class=md-nav__link> Modbus Bridge </a> </li> <li class=md-nav__item> <a href=../OpenTherm/ class=md-nav__link> OpenTherm </a> </li> <li class=md-nav__item> <a href=../RF-Protocol/ class=md-nav__link> RF Communication </a> </li> <li class=md-nav__item> <a href=../Serial-to-TCP-Bridge/ class=md-nav__link> Serial to TCP Bridge </a> </li> <li class=md-nav__item> <a href=../Zigbee/ class=md-nav__link> Zigbee </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../Smart-Meter-Interface/ class=md-nav__link> Smart Meter Interface </a> </li> <li class=md-nav__item> <a href=../Thermostat/ class=md-nav__link> Thermostat </a> </li> <li class=md-nav__item> <a href=../Timers/ class=md-nav__link> Timers </a> </li> <li class=md-nav__item> <a href=../TLS/ class=md-nav__link> TLS Secured MQTT </a> </li> <li class=md-nav__item> <a href=../TuyaMCU/ class=md-nav__link> TuyaMCU </a> </li> <li class=md-nav__item> <a href=../UFS/ class=md-nav__link> Universal File System </a> </li> <li class=md-nav__item> <a href=../Range-Extender/ class=md-nav__link> Wi-Fi Range Extender </a> </li> <li class=md-nav__item> <a href=../Tutorials/ class=md-nav__link> Projects and Tutorials </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> ESP32 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> ESP32 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../ESP32/ class=md-nav__link> Tasmota32 Features </a> </li> <li class=md-nav__item> <a href=../Berry/ class=md-nav__link> Berry </a> </li> <li class=md-nav__item> <a href=../Bluetooth_ESP32/ class=md-nav__link> Bluetooth Low Energy </a> </li> <li class=md-nav__item> <a href=../I2S-Audio/ class=md-nav__link> I2S Audio </a> </li> <li class=md-nav__item> <a href=../LVGL/ class=md-nav__link> LVGL </a> </li> <li class=md-nav__item> <a href=../HASPmota/ class=md-nav__link> HASPmota </a> </li> <li class=md-nav__item> <a href=../Tasmota-Application/ class=md-nav__link> Tasmota Application Files </a> </li> <li class=md-nav__item> <a href=../TouchPin/ class=md-nav__link> Touch GPIOs </a> </li> <li class=md-nav__item> <a href=../Safeboot/ class=md-nav__link> Safeboot Partition Layout </a> </li> <li class=md-nav__item> <a href=https://templates.blakadder.com/esp32 class=md-nav__link> Supported Devices </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> Smart Home Integrations <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Smart Home Integrations </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Integrations/ class=md-nav__link> Introduction </a> </li> <li class=md-nav__item> <a href=../Alexa/ class=md-nav__link> Alexa </a> </li> <li class=md-nav__item> <a href=../AWS-IoT/ class=md-nav__link> AWS IoT </a> </li> <li class=md-nav__item> <a href=../Domoticz/ class=md-nav__link> Domoticz </a> </li> <li class=md-nav__item> <a href=../Home-Assistant/ class=md-nav__link> Home Assistant </a> </li> <li class=md-nav__item> <a href=../Homebridge/ class=md-nav__link> Homebridge </a> </li> <li class=md-nav__item> <a href=../HomeSeer/ class=md-nav__link> HomeSeer </a> </li> <li class=md-nav__item> <a href=../IP-Symcon/ class=md-nav__link> IP Symcon </a> </li> <li class=md-nav__item> <a href=../KNX/ class=md-nav__link> KNX </a> </li> <li class=md-nav__item> <a href=../NodeRed/ class=md-nav__link> NodeRed </a> </li> <li class=md-nav__item> <a href=../nymea/ class=md-nav__link> nymea </a> </li> <li class=md-nav__item> <a href=../Octoprint/ class=md-nav__link> OctoPrint </a> </li> <li class=md-nav__item> <a href=../openHAB/ class=md-nav__link> openHAB </a> </li> <li class=md-nav__item> <a href=../otto/ class=md-nav__link> Otto </a> </li> <li class=md-nav__item> <a href=https://github.com/arendst/Tasmota/issues/3769 class=md-nav__link> IOBroker </a> </li> <li class=md-nav__item> <a href=https://github.com/tim-hellhake/tasmota-adapter class=md-nav__link> Mozilla WebThings Adapter </a> </li> <li class=md-nav__item> <a href=https://github.com/hongtat/tasmota-connect class=md-nav__link> SmartThings </a> </li> <li class=md-nav__item> <a href=https://github.com/Gifford47/tasmohab/blob/master/README.md class=md-nav__link> Tasmohab </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../Supported-Peripherals/ class=md-nav__link> Peripherals </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> Supported Devices <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Supported Devices </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Configuration-Procedure-for-New-Devices/ class=md-nav__link> Configure Unknown Device </a> </li> <li class=md-nav__item> <a href="https://templates.blakadder.com/ " target='_blank""' class=md-nav__link> All Supported Devices </a> </li> <li class=md-nav__item> <a href=../Pinouts/ class=md-nav__link> Wi-Fi Module Pinouts </a> </li> <li class=md-nav__item> <a href=../Supported-Modules/ class=md-nav__link> Supported Modules </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex=0> Help <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Help </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../FAQ/ class=md-nav__link> FAQ </a> </li> <li class=md-nav__item> <a href=../Troubleshooting/ class=md-nav__link> Troubleshooting </a> </li> <li class=md-nav__item> <a href=../Device-Recovery/ class=md-nav__link> Device Recovery </a> </li> <li class=md-nav__item> <a href="https://discord.gg/Ks2Kzd4 " target='_blank""' class=md-nav__link> Discord Support </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=http://tasmota.github.io/install class=md-nav__link> Web Installer </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#connection class=md-nav__link> Connection </a> <nav class=md-nav aria-label=Connection> <ul class=md-nav__list> <li class=md-nav__item> <a href=#using-wifi-port class=md-nav__link> Using WIFI Port </a> </li> <li class=md-nav__item> <a href=#using-extern-port class=md-nav__link> Using EXTERN Port </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#configuration class=md-nav__link> Configuration </a> <nav class=md-nav aria-label=Configuration> <ul class=md-nav__list> <li class=md-nav__item> <a href=#tasmota-settings class=md-nav__link> Tasmota settings </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#sensor-data class=md-nav__link> SENSOR data </a> </li> <li class=md-nav__item> <a href=#commands class=md-nav__link> Commands </a> <nav class=md-nav aria-label=Commands> <ul class=md-nav__list> <li class=md-nav__item> <a href=#examples class=md-nav__link> Examples </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#enhancements class=md-nav__link> Enhancements </a> <nav class=md-nav aria-label=Enhancements> <ul class=md-nav__list> <li class=md-nav__item> <a href=#daily-sync-device-to-tasmota-time class=md-nav__link> Daily sync device to Tasmota time </a> </li> <li class=md-nav__item> <a href=#esp82xx-add-buttons-for-filtration-and-light-control class=md-nav__link> ESP82xx: Add buttons for filtration and light control </a> </li> <li class=md-nav__item> <a href=#esp32-adding-user-defined-neopool-commands-to-tasmota class=md-nav__link> ESP32: Adding user defined NeoPool commands to Tasmota </a> </li> <li class=md-nav__item> <a href=#esp32-add-gui-controls-for-filtration-light-and-aux-relais class=md-nav__link> ESP32: Add GUI controls for filtration, light and aux relais </a> </li> <li class=md-nav__item> <a href=#esp32-make-the-scripts-persistent class=md-nav__link> ESP32: Make the scripts persistent </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/tasmota/docs/blob/master/docs/NeoPool.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg> </a> <h1 id=sugar-valley-neopool-controller>Sugar Valley NeoPool Controller<a class=headerlink href=#sugar-valley-neopool-controller title="Permanent link">~</a></h1> <details class=failure> <summary>This feature is not included in precompiled binaries</summary> <p>When <a href=../Compile-your-build/ >compiling your build</a> add the following to <code>user_config_override.h</code>: <div class=highlight><pre><span></span><code><span class=cp>#ifndef USE_NEOPOOL</span>
<span class=cp>#define USE_NEOPOOL                       </span><span class=c1>// Add support for Sugar Valley NeoPool Controller - also known under brands Hidrolife, Aquascenic, Oxilife, Bionet, Hidroniser, UVScenic, Station, Brilix, Bayrol and Hay (+6k flash, +60 mem)</span>
<span class=cp>#endif</span>
</code></pre></div></p> </details> <p><a href=https://sugar-valley.net/en/productos/ >Sugar Valley</a> NeoPool are water treatment systems also known under the names Hidrolife, Aquascenic, Oxilife, Bionet, Hidroniser, UVScenic, Station, Brilix, Bayrol and Hay. It uses a <a href=https://en.wikipedia.org/wiki/RS-485>RS485</a> interface with the <a href=https://en.wikipedia.org/wiki/Modbus>Modbus</a> data protocol for enhancement equipment like Wifi-Interface or a second attached control panel. All functions and parameters can be queried and controlled via this bus interface.</p> <p>The Tasmota Sugar Valley NeoPool Controller sensor module shows the most of parameters such as the built-in display:</p> <p><img alt src=../_media/xsns_83_neopool_s.png></p> <p>There are <a href=#commands>Tasmota commands</a> implemented to control the high level functions for filtration, light and system parameters such as pH set point, hydrolysis level, redox set point etc. However, the sensor also provides low-level commands to directly <a href=#NPRead>read</a> and <a href=#NPWrite>write</a> NeoPool register, means that you have the option to implement your own commands via home automation systems or by using the Tasmota build-in possibilities <a href=../Commands/#rules>Rules</a> with <a href=../Commands/#the-power-of-backlog>Backlog</a> or the powerful Berry language on ESP32.</p> <h2 id=connection>Connection<a class=headerlink href=#connection title="Permanent link">~</a></h2> <p>The NeoPool controller uses a RS485 interface, the ESP has RS232 interfaces. Both are serial interfaces but with different physical specifications. Therefore to connect your NeoPool controller to an ESP82xx/32 you need a TTL-UART to RS485 converter. It is recommended to use GPIO1 and GPIO3 on ESP8266 side, since the ESP then uses the hardware serial interface.</p> <p><img alt src=../_media/xsns_83_neopool_schematic.png></p> <p>The following TTL UART to RS485 converter have been tested with both an ESP8266 and ESP32 using a Vcc of 3.3V:</p> <p><img alt src=../_media/xsns_83_neopool_rs485_1_s.png> <img alt src=../_media/xsns_83_neopool_rs485_2_s.png></p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>Your TTL UART to RS485 converter must be able to work with an operating voltage of 3.3V. Some converters are not designed for operating with 3.3V and only works with 5V TTL level - these converters are useless. <strong>Do not operate your TTL UART to RS485 converter with 5V</strong>, your converter <strong>must be operated with the 3.3V</strong> from ESP, otherwise the ESP GPIO ports will be damaged.</p> </div> <p>The Sugar Valley NeoPool RS485 connector pins are located under the connection cover, for the Sugar-Valley products on the right-hand side next to the relay connections:</p> <p>The pin assignment (from top to bottom):</p> <table> <thead> <tr> <th>Pin</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>1</td> <td>+12V</td> </tr> <tr> <td>2</td> <td>nc</td> </tr> <tr> <td>3</td> <td>Modbus A+</td> </tr> <tr> <td>4</td> <td>Modbus B-</td> </tr> <tr> <td>5</td> <td>Modbus GND</td> </tr> </tbody> </table> <div class="admonition failure"> <p class=admonition-title>The +12V connection is the 12V from the internal power supply, do not feed in any external voltage.</p> </div> <p>You can use the "WIFI" or "EXTERN" connector, both are independent Modbus channels and uses the Modbus address 1 by default.</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>The "DISPLAY" port can only be used if neither the built-in nor an external display is connected but since there is probably at least one display connected to one of the two "DISPLAY" ports, the "DISPLAY" port is useless.</p> </div> <h3 id=using-wifi-port>Using WIFI Port<a class=headerlink href=#using-wifi-port title="Permanent link">~</a></h3> <p><img alt src=../_media/xsns_83_neopool_connector_wifi.jpg></p> <h3 id=using-extern-port>Using EXTERN Port<a class=headerlink href=#using-extern-port title="Permanent link">~</a></h3> <p><img alt src=../_media/xsns_83_neopool_connector.jpg></p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>Leave the define for <code>NEOPOOL_MODBUS_ADDRESS</code> set to 1 whether you are using the "WIFI" or "EXTERNAL" port (unless you have changed the parameters for it within your Sugar Valley device).</p> </div> <h2 id=configuration>Configuration<a class=headerlink href=#configuration title="Permanent link">~</a></h2> <h3 id=tasmota-settings>Tasmota settings<a class=headerlink href=#tasmota-settings title="Permanent link">~</a></h3> <p>If you followed the recommendations above, the two GPIOs will be assigned as follows under Tasmota <strong><em>Configuration -&gt; Configure Module</em></strong>:</p> <ul> <li>first change Module type to <code>Generic (0)</code> - this will restart your Tasmota</li> </ul> <p>After restart set * GPIO1 to <code>NeoPool RX</code> * GPIO3 to <code>NeoPool TX</code></p> <p>so it looks like this</p> <p><img alt src=../_media/xsns_83_neopool_config.png></p> <p>Don't be surprised that Rx seems to be connected to Tx here (and vice versa). The Rx and Tx designations are to be considered from the point of view of the respective devices, which can be confusing.</p> <p>After Tasmota restarts, the main screen should display the controller data as shown above. If not, check that the A+/B pins aren't swapped and that the Rx/Tx pins are on the correct GPIOs - swap once if in doubt.</p> <h2 id=sensor-data>SENSOR data<a class=headerlink href=#sensor-data title="Permanent link">~</a></h2> <p>Sensor data is sent via the Tasmota topic <code>tele/%topic%/SENSOR</code> in JSON format every <a href=../Commands/#teleperiod>TelePeriod</a> interval. To get the data immediately, use the Tasmota <a href=../Commands/#teleperiod>TelePeriod</a> command without parameter:</p> <div class=highlight><pre><span></span><code><span class=p>{</span>
<span class=w>  </span><span class=nt>&quot;Time&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;2021-06-01T11:00:00+02:00&quot;</span><span class=p>,</span>
<span class=w>  </span><span class=nt>&quot;NeoPool&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nt>&quot;Time&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;2021-06-01T11:00:00&quot;</span><span class=p>,</span>
<span class=w>    </span><span class=nt>&quot;Type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Oxilife&quot;</span><span class=p>,</span>
<span class=w>    </span><span class=nt>&quot;Module&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=nt>&quot;pH&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>1</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;Redox&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>1</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;Hydrolysis&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>1</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;Chlorine&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>1</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;Conductivity&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>1</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;Ionization&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>1</span>
<span class=w>    </span><span class=p>},</span>
<span class=w>    </span><span class=nt>&quot;Temperature&quot;</span><span class=p>:</span><span class=w> </span><span class=mf>23.5</span><span class=p>,</span>
<span class=w>    </span><span class=nt>&quot;Power&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=nt>&quot;Version&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;V3.45&quot;</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;NodeID&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;2A55 6E6B 6E6F 776E 2049 442A&quot;</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;5V&quot;</span><span class=p>:</span><span class=w> </span><span class=mf>5.017</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;12V&quot;</span><span class=p>:</span><span class=w> </span><span class=mf>13.904</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;24-30V&quot;</span><span class=p>:</span><span class=w> </span><span class=mf>33.721</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;4-20mA&quot;</span><span class=p>:</span><span class=w> </span><span class=mf>0.01</span>
<span class=w>    </span><span class=p>},</span>
<span class=w>    </span><span class=nt>&quot;pH&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=nt>&quot;Data&quot;</span><span class=p>:</span><span class=w> </span><span class=mf>7.2</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;Min&quot;</span><span class=p>:</span><span class=w> </span><span class=mf>7.0</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;Max&quot;</span><span class=p>:</span><span class=w> </span><span class=mf>7.2</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;State&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;Pump&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>2</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;FL1&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;Tank&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>1</span>
<span class=w>    </span><span class=p>},</span>
<span class=w>    </span><span class=nt>&quot;Redox&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=nt>&quot;Data&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>752</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;Setpoint&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>750</span>
<span class=w>    </span><span class=p>},</span>
<span class=w>    </span><span class=nt>&quot;Chlorine&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=nt>&quot;Data&quot;</span><span class=p>:</span><span class=w> </span><span class=mf>0.7</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;Setpoint&quot;</span><span class=p>:</span><span class=w> </span><span class=mf>1.0</span>
<span class=w>    </span><span class=p>},</span>
<span class=w>    </span><span class=nt>&quot;Conductivity&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>,</span>
<span class=w>    </span><span class=nt>&quot;Ionization&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=nt>&quot;Data&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;Setpoint&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;Max&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>0</span>
<span class=w>    </span><span class=p>},</span>
<span class=w>    </span><span class=nt>&quot;Hydrolysis&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=nt>&quot;Data&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>100</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;Unit&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;%&quot;</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;Runtime&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nt>&quot;Total&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;28T22:13:19&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;Part&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;28T22:13:02&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;Pol1&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;14T12:32:46&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;Pol2&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;14T09:40:33&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;Changes&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>258</span>
<span class=w>      </span><span class=p>},</span>
<span class=w>      </span><span class=nt>&quot;State&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Pol1&quot;</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;Cover&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;Boost&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;Low&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>0</span>
<span class=w>    </span><span class=p>},</span>
<span class=w>    </span><span class=nt>&quot;Filtration&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=nt>&quot;State&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>1</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;Speed&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>2</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;Mode&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>1</span>
<span class=w>    </span><span class=p>},</span>
<span class=w>    </span><span class=nt>&quot;Light&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>,</span>
<span class=w>    </span><span class=nt>&quot;Relay&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=nt>&quot;State&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>],</span>
<span class=w>      </span><span class=nt>&quot;Aux&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>],</span>
<span class=w>      </span><span class=nt>&quot;Acid&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>0</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>  </span><span class=p>},</span>
<span class=w>  </span><span class=nt>&quot;TempUnit&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;C&quot;</span>
<span class=p>}</span>
</code></pre></div> <p>The JSON values "pH", "Redox", "Hydrolysis", "Chlorine", "Conductivity" and "Ionization" are only available if the corresponding module is installed in the device (the corresponding "Module" subkey must be 1 ).</p> <p>To check which modules are installed use the "Module" value from SENSOR topic or query it manually by using the <a href=#NPControl>NPControl command</a>:</p> <div class=highlight><pre><span></span><code><span class=p>{</span>
<span class=w>  </span><span class=nt>&quot;Modules&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nt>&quot;pH&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>1</span><span class=p>,</span>
<span class=w>    </span><span class=nt>&quot;Redox&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>1</span><span class=p>,</span>
<span class=w>    </span><span class=nt>&quot;Hydrolysis&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>1</span><span class=p>,</span>
<span class=w>    </span><span class=nt>&quot;Chlorine&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>,</span>
<span class=w>    </span><span class=nt>&quot;Conductivity&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>,</span>
<span class=w>    </span><span class=nt>&quot;Ionization&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>0</span>
<span class=w>  </span><span class=p>},</span>
<span class=w>  </span><span class=nt>&quot;Relay&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nt>&quot;Acid&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>1</span><span class=p>,</span>
<span class=w>    </span><span class=nt>&quot;Base&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>,</span>
<span class=w>    </span><span class=nt>&quot;Redox&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>,</span>
<span class=w>    </span><span class=nt>&quot;Chlorine&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>,</span>
<span class=w>    </span><span class=nt>&quot;Conductivity&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>,</span>
<span class=w>    </span><span class=nt>&quot;Heating&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>,</span>
<span class=w>    </span><span class=nt>&quot;UV&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>,</span>
<span class=w>    </span><span class=nt>&quot;Valve&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>0</span>
<span class=w>  </span><span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <h2 id=commands>Commands<a class=headerlink href=#commands title="Permanent link">~</a></h2> <p>This sensor supports some high-level <a href=#commands>commands</a> for end user.</p> <p>Regardless, all other Modbus registers can be read and write, so you can <a href=#Enhancements>enhance</a> your Sugar Valley control by using low-level <a href=#NPRead>NPRead</a>/<a href=#NPWrite>NPWrite</a> commands.</p> <p>Modbus register addresses and their meaning are described within source file <a href=https://github.com/arendst/Tasmota/blob/development/tasmota/xsns_83_neopool.ino>xsns_83_neopool.ino</a> at the beginning and (partly) within document <a href=https://downloads.vodnici.net/uploads/wpforo/attachments/69/171-Modbus-registers.pdf>171-Modbus-registers</a>.<br> Please note that Sugar Valley Modbus registers are not byte addresses but modbus registers containing 16-bit values - don't think in byte memory layout.</p> <table> <thead> <tr> <th align=left>Command</th> <th align=left>Parameters</th> </tr> </thead> <tbody> <tr> <td align=left>NPFiltration<a id=NPFiltration></a></td> <td align=left><code>{&lt;state&gt; {speed}}</code><br>get/set manual filtration (state = <code>0</code> or <code>1</code>, speed = <code>1..3</code>). Get if state is omitted, otherwise set accordingly <code>&lt;state&gt;</code>:<ul><li><code>0</code> - manual turn filtration pump off</li><li><code>1</code> - manual turn filtration pump on</li></ul>optional speed control is possible for non-standard filtration types:<ul><li><code>1</code> - slow</li><li><code>2</code> - medium</li><li><code>3</code> - fast</li></ul></td> </tr> <tr> <td align=left>NPFiltrationmode<a id=NPFiltrationmode></a></td> <td align=left><code>{&lt;mode&gt;}</code><br>get/set filtration mode (mode = <code>0..4</code> or <code>13</code>). Get if mode is omitted, otherwise set accordingly <code>&lt;mode&gt;</code>:<ul><li><code>0</code> - <em>MANUAL</em><br>allows to turn the filtration (and all other systems that depend on it) on and off</li><li><code>1</code> - <em>AUTO</em><br>allows filtering to be turned on and off according to the settings of the <em>MBF_PAR_TIMER_BLOCK_FILT_INT</em> timers.</li><li><code>2</code> - <em>HEATING</em><br>similar to the AUTO mode, but includes setting the temperature for the heating function. This mode is activated only if the BF_PAR_HEATING_MODE register is at 1 and there is a heating relay assigned.</li><li><code>3</code> - <em>SMART</em><br>adjusts the pump operating times depending on the temperature. This mode is activated only if the MBF_PAR_TEMPERATURE_ACTIVE register is at 1.</li><li><code>4</code> - <em>INTELLIGENT</em><br>performs an intelligent filtration process in combination with the heating function. This mode is activated only if the MBF_PAR_HEATING_MODE register is at 1 and there is a heating relay assigned.</li><li><code>13</code> - <em>BACKWASH</em><br>started when the backwash operation is activated.</ul></td> </tr> <tr> <td align=left>NPTime<a id=NPTime></a></td> <td align=left><code>{&lt;time&gt;}</code><br>get/set device time. Get if time is omitted, otherwise set device time accordingly <code>&lt;time&gt;</code>:<ul><li><code>0</code> - sync with Tasmota local time</li><li><code>1</code> - sync with Tasmota utc time</li><li><code>2..4294967295</code> - set time as epoch</li></ul></td> </tr> <tr> <td align=left>NPLight<a id=NPLight></a></td> <td align=left><code>{&lt;state&gt; {delay}}</code><br>get/set light (state = <code>0..4</code>, delay = <code>5..100</code> in 1/10 sec). Get if state is omitted, otherwise set accordingly <code>&lt;state&gt;</code>:<ul><li><code>0</code> - manual turn light off</li><li><code>1</code> - manual turn light on</li><li><code>2</code> - manual toggle light</li><li><code>3</code> - switch light into auto mode according MBF_PAR_TIMER_BLOCK_LIGHT_INT settings</li><li><code>4</code> - select light RGB LED to next program. This is normally done by power the light on (if currently off), then power off the light for a given time (delay) and power on again. The default delay is 15 (=1.5 sec).</ul></td> </tr> <tr> <td align=left>NPpHMin<a id=NPpHMin></a></td> <td align=left><code>{&lt;ph&gt;}</code><br>(only available if pH module is installed)<br>get/set pH lower limit (ph = <code>0..14</code>)<br>get current limit if <ph> is omitted, otherwise set.</td> </tr> <tr> <td align=left>NPpHMax<a id=NPpHMax></a></td> <td align=left><code>{&lt;ph&gt;}</code><br>(only available if pH module is installed)<br>get/set pH upper limit (ph = <code>0..14</code>)<br>get current limit if <ph> is omitted, otherwise set.</td> </tr> <tr> <td align=left>NPpH<a id=NPpH></a></td> <td align=left><code>{&lt;ph&gt;}</code><br>(only available if pH module is installed)<br>get/set pH upper limit (ph = <code>0..14</code>)<br>same as NPpHMax</td> </tr> <tr> <td align=left>NPRedox<a id=NPRedox></a></td> <td align=left><code>{&lt;setpoint&gt;}</code><br>(only available if redox module is installed)<br>get/set redox set point in mV (setpoint = <code>0..100</code>, the upper limit of the range may vary depending on the MBF_PAR_HIDRO_NOM register)<br>get current set point if <setpoint> is omitted, otherwise set</td> </tr> <tr> <td align=left>NPHydrolysis<a id=NPHydrolysis></a></td> <td align=left><code>{&lt;level&gt;}</code><br>(only available if hydrolysis/electrolysis control is present)<br>get/set hydrolysis/electrolysis level in % (level = <code>0..100</code>)<br>get current level if <level> is omitted, otherwise set</td> </tr> <tr> <td align=left>NPIonization<a id=NPIonization></a></td> <td align=left><code>{&lt;level&gt;}</code><br>(only available if ionization control is present)<br>get/set ionization target production level (level = <code>0..x</code>, the upper limit <code>x</code> of the range may vary depending on the MBF_PAR_ION_NOM register)<br>get current level if <level> is omitted, otherwise set</td> </tr> <tr> <td align=left>NPChlorine<a id=NPChlorine></a></td> <td align=left><code>{&lt;setpoint&gt;}</code><br>(only available if free chlorine probe detector is installed)<br>get/set chlorine set point in ppm (setpoint = <code>0..10</code>)<br>get current set point if <setpoint> is omitted, otherwise set</td> </tr> <tr> <td align=left>NPControl<a id=NPControl></a></td> <td align=left><br>Show information about system controls</td> </tr> <tr> <td align=left>NPOnError<a id=NPOnError></a></td> <td align=left><code>{&lt;repeat&gt;}</code><br>get/set auto-repeat Modbus read/write commands on error (repeat = <code>0..10</code>). Get if repeat is omitted, otherwise set accordingly <code>&lt;repeat&gt;</code>:<ul><li><code>0</code> - disable auto-repeat on read/write error</li><li><code>1..10</code> - repeat commands n times until ok</li></ul></td> </tr> <tr> <td align=left>NPResult<a id=NPResult></a></td> <td align=left><code>{&lt;format&gt;}</code><br>get/set addr/data result format for read/write commands (format = <code>0|1</code>). Get if format is omitted, otherwise set accordingly <code>&lt;format&gt;</code>:<ul><li><code>0</code> - output decimal numbers</li><li><code>1</code> - output hexadecimal strings, this is the default</li></ul></td> </tr> <tr> <td align=left>NPPHRes<a id=NPPHRes></a></td> <td align=left><code>{&lt;digits&gt;}</code><br>get/set number of digits in results for PH value (digits = <code>0..3</code>).</td> </tr> <tr> <td align=left>NPCLRes<a id=NPCLRes></a></td> <td align=left><code>{&lt;digits&gt;}</code><br>get/set number of digits in results for CL value (digits = <code>0..3</code>).</td> </tr> <tr> <td align=left>NPIONRes<a id=NPIONRes></a></td> <td align=left><code>{&lt;digits&gt;}</code><br>get/set number of digits in results for ION value (digits = <code>0..3</code>).</td> </tr> <tr> <td align=left>NPRead<a id=NPRead></a></td> <td align=left><code>&lt;addr&gt; {&lt;cnt&gt;}</code><br>read 16-bit register (addr = <code>0..0x060F</code>, cnt = <code>1..30</code>). cnt = <code>1</code> if omitted</td> </tr> <tr> <td align=left>NPReadL<a id=NPReadL></a></td> <td align=left><code>&lt;addr&gt; {&lt;cnt&gt;}</code><br>read 32-bit register (addr = <code>0..0x060F</code>, cnt = <code>1..15</code>). cnt = <code>1</code> if omitted</td> </tr> <tr> <td align=left>NPWrite<a id=NPWrite></a></td> <td align=left><code>&lt;addr&gt; &lt;data&gt; {&lt;data&gt;...}</code><br>write 16-bit register (addr = <code>0..0x060F</code>, data = <code>0..0xFFFF</code>). Use of data max 10 times</td> </tr> <tr> <td align=left>NPWriteL<a id=NPWriteL></a></td> <td align=left><code>&lt;addr&gt; &lt;data&gt; {&lt;data&gt;...}</code><br>write 32-bit register (addr = <code>0..0x060F</code>, data = <code>0..0xFFFFFFFF</code>). Use of data max 10 times</td> </tr> <tr> <td align=left>NPBit<a id=NPBit></a></td> <td align=left><code>&lt;addr&gt; &lt;bit&gt; {&lt;data&gt;}</code><br>read/write a 16-bit register single bit (addr = <code>0..0x060F</code>, bit = <code>0..15</code>, data = <code>0|1</code>). Read if data is omitted, otherwise set single bit</td> </tr> <tr> <td align=left>NPBitL<a id=NPBitL></a></td> <td align=left><code>&lt;addr&gt; &lt;bit&gt; {&lt;data&gt;}</code><br>read/write a 32-bit register single bit (addr = <code>0..0x060F</code>, bit = <code>0..31</code>, data = <code>0|1</code>). Read if data is omitted, otherwise set single bit</td> </tr> <tr> <td align=left>NPEscape<a id=NPEscape></a></td> <td align=left>clears possible errors (like pump exceeded time etc.)</td> </tr> <tr> <td align=left>NPExec<a id=NPExec></a></td> <td align=left>take over changes without writing to EEPROM. This command is necessary e.g. on changes in <em>Installer page</em> (addr 0x0400..0x04EE).</td> </tr> <tr> <td align=left>NPSave<a id=NPSave></a></td> <td align=left>write data permanently into EEPROM.<br>During the EEPROM write procedure the NeoPool device may be unresponsive to MODBUS requests, this process always takes less than 1 second.<br>Since this process is limited by the number of EEPROM write cycles, it is recommend to write all necessary changes to the registers and only then execute EEPROM write process using this command.<br><strong>Note: The number of EEPROM writes for Sugar Valley NeoPool devices is guaranteed 100,000 cycles. As soon as this number is exceeded, further storage of information can no longer be guaranteed</strong>.</td> </tr> </tbody> </table> <h3 id=examples>Examples<a class=headerlink href=#examples title="Permanent link">~</a></h3> <div class="admonition example"> <p class=admonition-title>Example</p> <p>Get filtration mode</p> </div> <div class=highlight><pre><span></span><code><span class=err>NPFil</span><span class=kc>trat</span><span class=err>io</span><span class=kc>n</span><span class=err>mode</span>
<span class=err>RESULT</span><span class=w> </span><span class=err>=</span><span class=w> </span><span class=p>{</span><span class=nt>&quot;NPFiltrationmode&quot;</span><span class=p>:</span><span class=s2>&quot;Manual&quot;</span><span class=p>}</span>
</code></pre></div> <div class="admonition example"> <p class=admonition-title>Example</p> <p>Set filtration mode</p> </div> <div class=highlight><pre><span></span><code><span class=err>NPFil</span><span class=kc>trat</span><span class=err>io</span><span class=kc>n</span><span class=err>mode</span><span class=w> </span><span class=mi>1</span>
<span class=p>{</span><span class=nt>&quot;NPFiltrationmode&quot;</span><span class=p>:</span><span class=s2>&quot;Auto&quot;</span><span class=p>}</span>
</code></pre></div> <div class="admonition example"> <p class=admonition-title>Example</p> <p>Enable hydrolysis boost mode without redox control</p> </div> <p>To do this, write <code>0x85A0</code> to register <code>MBF_BOOST_CTRL</code> (<code>0x020C</code>), exec, save it and notify system using register <code>MBF_NOTIFICATION</code> (<code>0x0110</code>) about changes:</p> <div class=highlight><pre><span></span><code><span class=err>Backlog</span><span class=w> </span><span class=err>NPWri</span><span class=kc>te</span><span class=w> </span><span class=mi>0</span><span class=err>x</span><span class=mi>020</span><span class=err>C</span><span class=p>,</span><span class=mi>0</span><span class=err>x</span><span class=mi>85</span><span class=err>A</span><span class=mi>0</span><span class=err>;NPSave;NPExec;NPWri</span><span class=kc>te</span><span class=w> </span><span class=mi>0</span><span class=err>x</span><span class=mi>0110</span><span class=p>,</span><span class=mi>0</span><span class=err>x</span><span class=mi>7</span><span class=err>F</span>
<span class=err>RESULT</span><span class=w> </span><span class=err>=</span><span class=w> </span><span class=p>{</span><span class=nt>&quot;NPWrite&quot;</span><span class=p>:{</span><span class=nt>&quot;Address&quot;</span><span class=p>:</span><span class=s2>&quot;0x020C&quot;</span><span class=p>,</span><span class=nt>&quot;Data&quot;</span><span class=p>:</span><span class=s2>&quot;0x85A0&quot;</span><span class=p>}}</span>
<span class=err>RESULT</span><span class=w> </span><span class=err>=</span><span class=w> </span><span class=p>{</span><span class=nt>&quot;NPSave&quot;</span><span class=p>:</span><span class=s2>&quot;Done&quot;</span><span class=p>}</span>
<span class=err>RESULT</span><span class=w> </span><span class=err>=</span><span class=w> </span><span class=p>{</span><span class=nt>&quot;NPExec&quot;</span><span class=p>:</span><span class=s2>&quot;Done&quot;</span><span class=p>}</span>
<span class=err>RESULT</span><span class=w> </span><span class=err>=</span><span class=w> </span><span class=p>{</span><span class=nt>&quot;NPWrite&quot;</span><span class=p>:{</span><span class=nt>&quot;Address&quot;</span><span class=p>:</span><span class=s2>&quot;0x0110&quot;</span><span class=p>,</span><span class=nt>&quot;Data&quot;</span><span class=p>:</span><span class=s2>&quot;0x0000&quot;</span><span class=p>}}</span>
</code></pre></div> <div class="admonition example"> <p class=admonition-title>Example</p> <p>Disable hydrolysis boost mode</p> </div> <p>To do this, write <code>0</code> to register <code>MBF_BOOST_CTRL</code> (<code>0x020C</code>), exec, save it and notify system using register <code>MBF_NOTIFICATION</code> (<code>0x0110</code>) about changes:</p> <div class=highlight><pre><span></span><code><span class=err>Backlog</span><span class=w> </span><span class=err>NPWri</span><span class=kc>te</span><span class=w> </span><span class=mi>0</span><span class=err>x</span><span class=mi>020</span><span class=err>C</span><span class=p>,</span><span class=mi>0</span><span class=err>;NPSave;NPExec;NPWri</span><span class=kc>te</span><span class=w> </span><span class=mi>0</span><span class=err>x</span><span class=mi>0110</span><span class=p>,</span><span class=mi>0</span><span class=err>x</span><span class=mi>7</span><span class=err>F</span>
<span class=err>RESULT</span><span class=w> </span><span class=err>=</span><span class=w> </span><span class=p>{</span><span class=nt>&quot;NPWrite&quot;</span><span class=p>:{</span><span class=nt>&quot;Address&quot;</span><span class=p>:</span><span class=s2>&quot;0x020C&quot;</span><span class=p>,</span><span class=nt>&quot;Data&quot;</span><span class=p>:</span><span class=s2>&quot;0x0000&quot;</span><span class=p>}}</span>
<span class=err>RESULT</span><span class=w> </span><span class=err>=</span><span class=w> </span><span class=p>{</span><span class=nt>&quot;NPSave&quot;</span><span class=p>:</span><span class=s2>&quot;Done&quot;</span><span class=p>}</span>
<span class=err>RESULT</span><span class=w> </span><span class=err>=</span><span class=w> </span><span class=p>{</span><span class=nt>&quot;NPExec&quot;</span><span class=p>:</span><span class=s2>&quot;Done&quot;</span><span class=p>}</span>
<span class=err>RESULT</span><span class=w> </span><span class=err>=</span><span class=w> </span><span class=p>{</span><span class=nt>&quot;NPWrite&quot;</span><span class=p>:{</span><span class=nt>&quot;Address&quot;</span><span class=p>:</span><span class=s2>&quot;0x0110&quot;</span><span class=p>,</span><span class=nt>&quot;Data&quot;</span><span class=p>:</span><span class=s2>&quot;0x0000&quot;</span><span class=p>}}</span>
</code></pre></div> <div class="admonition example"> <p class=admonition-title>Example</p> <p>Switch light relay on</p> </div> <div class=highlight><pre><span></span><code><span class=err>NPLigh</span><span class=kc>t</span><span class=w> </span><span class=mi>1</span>
<span class=err>RESULT</span><span class=w> </span><span class=err>=</span><span class=w> </span><span class=p>{</span><span class=nt>&quot;NPLight&quot;</span><span class=p>:</span><span class=s2>&quot;ON&quot;</span><span class=p>}</span>
</code></pre></div> <div class="admonition example"> <p class=admonition-title>Example</p> <p>Read Heating setpoint temperature</p> </div> <p>Here we read register <code>MBF_PAR_HEATING_TEMP</code> (<code>0x0416</code>):</p> <div class=highlight><pre><span></span><code><span class=err>Backlog</span><span class=w> </span><span class=err>NPResul</span><span class=kc>t</span><span class=w> </span><span class=mi>0</span><span class=err>;NPRead</span><span class=w> </span><span class=mi>0</span><span class=err>x</span><span class=mi>416</span>
<span class=err>RESULT</span><span class=w> </span><span class=err>=</span><span class=w> </span><span class=p>{</span><span class=nt>&quot;NPResult&quot;</span><span class=p>:</span><span class=mi>0</span><span class=p>}</span>
<span class=err>RESULT</span><span class=w> </span><span class=err>=</span><span class=w> </span><span class=p>{</span><span class=nt>&quot;NPRead&quot;</span><span class=p>:{</span><span class=nt>&quot;Address&quot;</span><span class=p>:</span><span class=mi>1046</span><span class=p>,</span><span class=nt>&quot;Data&quot;</span><span class=p>:</span><span class=mi>28</span><span class=p>}}</span>
</code></pre></div> <div class="admonition example"> <p class=admonition-title>Example</p> <p>Enable additional factory menu</p> </div> <p>For that enable bit <code>MBMSK_SHOW_FACTORY_MENU</code> (15) in register <code>MBF_PAR_UICFG_VISUAL_OPTIONS</code> (<code>0x0605</code>)</p> <div class=highlight><pre><span></span><code><span class=err>Backlog</span><span class=w> </span><span class=err>NPBi</span><span class=kc>t</span><span class=w> </span><span class=mi>0</span><span class=err>x</span><span class=mi>605</span><span class=p>,</span><span class=mi>15</span><span class=p>,</span><span class=mi>1</span><span class=err>;NPSave</span>
<span class=err>RESULT</span><span class=w> </span><span class=err>=</span><span class=w> </span><span class=p>{</span><span class=nt>&quot;NPBit&quot;</span><span class=p>:{</span><span class=nt>&quot;Address&quot;</span><span class=p>:</span><span class=s2>&quot;0x0605&quot;</span><span class=p>,</span><span class=nt>&quot;Data&quot;</span><span class=p>:</span><span class=s2>&quot;0xAFC0&quot;</span><span class=p>,</span><span class=nt>&quot;Bit15&quot;</span><span class=p>:</span><span class=mi>1</span><span class=p>}}</span>
<span class=err>RESULT</span><span class=w> </span><span class=err>=</span><span class=w> </span><span class=p>{</span><span class=nt>&quot;NPSave&quot;</span><span class=p>:</span><span class=s2>&quot;Done&quot;</span><span class=p>}</span>
</code></pre></div> <div class="admonition example"> <p class=admonition-title>Example</p> <p>Read system time</p> </div> <p>We either use command <code>NPTime</code> or read the 32-bit value starting <code>MBF_PAR_TIME_LOW</code> (<code>0x0408</code>) using decimal output:</p> <div class=highlight><pre><span></span><code><span class=err>Backlog</span><span class=w> </span><span class=err>NPResul</span><span class=kc>t</span><span class=w> </span><span class=mi>0</span><span class=err>;NPTime;NPReadL</span><span class=w> </span><span class=mi>0</span><span class=err>x</span><span class=mi>408</span>
<span class=err>RESULT</span><span class=w> </span><span class=err>=</span><span class=w> </span><span class=p>{</span><span class=nt>&quot;NPResult&quot;</span><span class=p>:</span><span class=mi>0</span><span class=p>}</span>
<span class=err>RESULT</span><span class=w> </span><span class=err>=</span><span class=w> </span><span class=p>{</span><span class=nt>&quot;NPTime&quot;</span><span class=p>:</span><span class=s2>&quot;2021-01-31T21:22:20&quot;</span><span class=p>}</span>
<span class=err>RESULT</span><span class=w> </span><span class=err>=</span><span class=w> </span><span class=p>{</span><span class=nt>&quot;NPReadL&quot;</span><span class=p>:{</span><span class=nt>&quot;Address&quot;</span><span class=p>:</span><span class=mi>1032</span><span class=p>,</span><span class=nt>&quot;Data&quot;</span><span class=p>:</span><span class=mi>1612124540</span><span class=p>}}</span>
</code></pre></div> <div class="admonition example"> <p class=admonition-title>Example</p> <p>Enable temperature module</p> </div> <p>Do this by enabling <code>MBF_PAR_TEMPERATURE_ACTIVE</code> (<code>0x04F</code>) and set it permanently in EEPROM::</p> <div class=highlight><pre><span></span><code><span class=err>Backlog</span><span class=w> </span><span class=err>NPWri</span><span class=kc>te</span><span class=w> </span><span class=mi>0</span><span class=err>x</span><span class=mi>40</span><span class=err>F</span><span class=p>,</span><span class=mi>1</span><span class=err>;NPSave</span>
<span class=err>RESULT</span><span class=w> </span><span class=err>=</span><span class=w> </span><span class=p>{</span><span class=nt>&quot;NPWrite&quot;</span><span class=p>:{</span><span class=nt>&quot;Address&quot;</span><span class=p>:</span><span class=s2>&quot;0x040F&quot;</span><span class=p>,</span><span class=nt>&quot;Data&quot;</span><span class=p>:</span><span class=s2>&quot;0x0001&quot;</span><span class=p>}}</span>
<span class=err>RESULT</span><span class=w> </span><span class=err>=</span><span class=w> </span><span class=p>{</span><span class=nt>&quot;NPSave&quot;</span><span class=p>:</span><span class=s2>&quot;Done&quot;</span><span class=p>}</span>
</code></pre></div> <div class="admonition example"> <p class=admonition-title>Example</p> <p>Hide auxiliary relay display from main menu</p> </div> <p>To do this, set bit <code>MBMSK_HIDE_AUX_RELAYS</code> (3) in register <code>MBF_PAR_UICFG_VISUAL_OPTIONS</code> (<code>0x0605</code>):</p> <div class=highlight><pre><span></span><code><span class=err>NPBi</span><span class=kc>t</span><span class=w> </span><span class=mi>0</span><span class=err>x</span><span class=mi>605</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>1</span>
<span class=err>RESULT</span><span class=w> </span><span class=err>=</span><span class=w> </span><span class=p>{</span><span class=nt>&quot;NPBit&quot;</span><span class=p>:{</span><span class=nt>&quot;Address&quot;</span><span class=p>:</span><span class=s2>&quot;0x0605&quot;</span><span class=p>,</span><span class=nt>&quot;Data&quot;</span><span class=p>:</span><span class=s2>&quot;0x08C8&quot;</span><span class=p>}}</span>
</code></pre></div> <div class="admonition example"> <p class=admonition-title>Example</p> <p>Read Filtration interval 1-3 settings</p> </div> <p>To do this, we read the registers <code>MBF_PAR_TIMER_BLOCK_FILT_INT1</code> (<code>0x0434</code>), <code>MBF_PAR_TIMER_BLOCK_FILT_INT2</code> (<code>0x0443</code>) and <code>MBF_PAR_TIMER_BLOCK_FILT_INT3</code> (<code>0x0452</code>) with offset <code>MBV_TIMER_OFFMB_TIMER_ENABLE</code> (0) as 16-bit values and the remaining timer offset values <code>MBV_TIMER_OFFMB_*</code> as 32-bit values:</p> <div class=highlight><pre><span></span><code><span class=err>Backlog</span><span class=w> </span><span class=err>NPResul</span><span class=kc>t</span><span class=w> </span><span class=mi>0</span><span class=err>;NPRead</span><span class=w> </span><span class=mi>0</span><span class=err>x</span><span class=mi>434</span><span class=err>;NPReadL</span><span class=w> </span><span class=mi>0</span><span class=err>x</span><span class=mi>435</span><span class=p>,</span><span class=mi>7</span><span class=err>;NPRead</span><span class=w> </span><span class=mi>0</span><span class=err>x</span><span class=mi>443</span><span class=err>;NPReadL</span><span class=w> </span><span class=mi>0</span><span class=err>x</span><span class=mi>444</span><span class=p>,</span><span class=mi>7</span><span class=err>;NPRead</span><span class=w> </span><span class=mi>0</span><span class=err>x</span><span class=mi>452</span><span class=err>;NPReadL</span><span class=w> </span><span class=mi>0</span><span class=err>x</span><span class=mi>0453</span><span class=p>,</span><span class=mi>7</span>
<span class=err>RESULT</span><span class=w> </span><span class=err>=</span><span class=w> </span><span class=p>{</span><span class=nt>&quot;NPResult&quot;</span><span class=p>:</span><span class=mi>0</span><span class=p>}</span>
<span class=err>RESULT</span><span class=w> </span><span class=err>=</span><span class=w> </span><span class=p>{</span><span class=nt>&quot;NPRead&quot;</span><span class=p>:{</span><span class=nt>&quot;Address&quot;</span><span class=p>:</span><span class=mi>1076</span><span class=p>,</span><span class=nt>&quot;Data&quot;</span><span class=p>:</span><span class=mi>1</span><span class=p>}}</span>
<span class=err>RESULT</span><span class=w> </span><span class=err>=</span><span class=w> </span><span class=p>{</span><span class=nt>&quot;NPReadL&quot;</span><span class=p>:{</span><span class=nt>&quot;Address&quot;</span><span class=p>:</span><span class=mi>1077</span><span class=p>,</span><span class=nt>&quot;Data&quot;</span><span class=p>:[</span><span class=mi>28800</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>86400</span><span class=p>,</span><span class=mi>14400</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=mi>0</span><span class=p>]}}</span>
<span class=err>RESULT</span><span class=w> </span><span class=err>=</span><span class=w> </span><span class=p>{</span><span class=nt>&quot;NPRead&quot;</span><span class=p>:{</span><span class=nt>&quot;Address&quot;</span><span class=p>:</span><span class=mi>1091</span><span class=p>,</span><span class=nt>&quot;Data&quot;</span><span class=p>:</span><span class=mi>1</span><span class=p>}}</span>
<span class=err>RESULT</span><span class=w> </span><span class=err>=</span><span class=w> </span><span class=p>{</span><span class=nt>&quot;NPReadL&quot;</span><span class=p>:{</span><span class=nt>&quot;Address&quot;</span><span class=p>:</span><span class=mi>1092</span><span class=p>,</span><span class=nt>&quot;Data&quot;</span><span class=p>:[</span><span class=mi>43200</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>86400</span><span class=p>,</span><span class=mi>21600</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=mi>0</span><span class=p>]}}</span>
<span class=err>RESULT</span><span class=w> </span><span class=err>=</span><span class=w> </span><span class=p>{</span><span class=nt>&quot;NPRead&quot;</span><span class=p>:{</span><span class=nt>&quot;Address&quot;</span><span class=p>:</span><span class=mi>1106</span><span class=p>,</span><span class=nt>&quot;Data&quot;</span><span class=p>:</span><span class=mi>1</span><span class=p>}}</span>
<span class=err>RESULT</span><span class=w> </span><span class=err>=</span><span class=w> </span><span class=p>{</span><span class=nt>&quot;NPReadL&quot;</span><span class=p>:{</span><span class=nt>&quot;Address&quot;</span><span class=p>:</span><span class=mi>1107</span><span class=p>,</span><span class=nt>&quot;Data&quot;</span><span class=p>:[</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>86400</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=mi>0</span><span class=p>]}}</span><span class=w> </span><span class=err>*</span>
</code></pre></div> <div class="admonition example"> <p class=admonition-title>Example</p> <p>Set filtration interval</p> </div> <p>Here we set interval 1 to a daily interval between 9:00 - 12:30 (9:00: 3600 * 9  32400 / 12:30  3,5h = 12600)</p> <p>For this write register <code>MBF_PAR_TIMER_BLOCK_FILT_INT1</code> (<code>0x0434</code>) using the offsets <code>MBV_TIMER_OFFMB_</code>. For the sake of simplicity we write 4 consecutive 32-bit registers:</p> <ul> <li><code>MBV_TIMER_OFFMB_TIMER_ON</code>: Timer start = 9<em>3600 + 00</em>60 = 32400</li> <li><code>MBV_TIMER_OFFMB_TIMER_OFF</code>: Timer stop - not used</li> <li><code>MBV_TIMER_OFFMB_TIMER_PERIOD</code>: Time in seconds between starting points = 86400 (means daily interval)</li> <li><code>MBV_TIMER_OFFMB_TIMER_INTERVAL</code>: Time in seconds that the timer has to run when started. This is the difference between 12:30 (12<em>3600 + 30</em>60 = 45000) and 9:30(see Timer start = 32400) = 12600</li> </ul> <div class=highlight><pre><span></span><code><span class=err>NPWri</span><span class=kc>te</span><span class=err>L</span><span class=w> </span><span class=mi>0</span><span class=err>x</span><span class=mi>435</span><span class=p>,</span><span class=mi>32400</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=mi>86400</span><span class=w> </span><span class=mi>12600</span>
<span class=err>RESULT</span><span class=w> </span><span class=err>=</span><span class=w> </span><span class=p>{</span><span class=nt>&quot;NPWriteL&quot;</span><span class=p>:{</span><span class=nt>&quot;Address&quot;</span><span class=p>:</span><span class=mi>1077</span><span class=p>,</span><span class=nt>&quot;Data&quot;</span><span class=p>:[</span><span class=mi>32400</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>86400</span><span class=p>,</span><span class=mi>12600</span><span class=p>]}}</span>
</code></pre></div> <div class="admonition example"> <p class=admonition-title>Example</p> <p>Manual switch relay 7 (Aux4)</p> </div> <p>To switch Aux4 ON, we set <code>MBF_PAR_TIMER_BLOCK_AUX4_INT1</code> (<code>0x04D9</code>) + <code>MBV_TIMER_OFFMB_TIMER_ENABLE</code> (0) to MBV_PAR_CTIMER_ALWAYS_ON (<code>3</code>):.</p> <div class=highlight><pre><span></span><code><span class=err>Backlog</span><span class=w> </span><span class=err>NPWri</span><span class=kc>te</span><span class=w> </span><span class=mi>0</span><span class=err>x</span><span class=mi>4</span><span class=err>D</span><span class=mi>9</span><span class=p>,</span><span class=mi>3</span><span class=err>;NPExec</span>
<span class=err>RESULT</span><span class=w> </span><span class=err>=</span><span class=w> </span><span class=p>{</span><span class=nt>&quot;NPWrite&quot;</span><span class=p>:{</span><span class=nt>&quot;Address&quot;</span><span class=p>:</span><span class=s2>&quot;0x04D9&quot;</span><span class=p>,</span><span class=nt>&quot;Data&quot;</span><span class=p>:</span><span class=s2>&quot;0x0003&quot;</span><span class=p>}}</span>
<span class=err>RESULT</span><span class=w> </span><span class=err>=</span><span class=w> </span><span class=p>{</span><span class=nt>&quot;NPExec&quot;</span><span class=p>:</span><span class=s2>&quot;Done&quot;</span><span class=p>}</span>
</code></pre></div> <p>To switch Aux4 OFF, we set <code>MBF_PAR_TIMER_BLOCK_AUX4_INT1</code> (<code>0x04D9</code>) + <code>MBV_TIMER_OFFMB_TIMER_ENABLE</code> (0) to MBV_PAR_CTIMER_ALWAYS_OFF (<code>4</code>):.</p> <div class=highlight><pre><span></span><code><span class=err>Backlog</span><span class=w> </span><span class=err>NPWri</span><span class=kc>te</span><span class=w> </span><span class=mi>0</span><span class=err>x</span><span class=mi>4</span><span class=err>D</span><span class=mi>9</span><span class=p>,</span><span class=mi>4</span><span class=err>;NPExec</span>
<span class=err>RESULT</span><span class=w> </span><span class=err>=</span><span class=w> </span><span class=p>{</span><span class=nt>&quot;NPWrite&quot;</span><span class=p>:{</span><span class=nt>&quot;Address&quot;</span><span class=p>:</span><span class=s2>&quot;0x04D9&quot;</span><span class=p>,</span><span class=nt>&quot;Data&quot;</span><span class=p>:</span><span class=s2>&quot;0x0004&quot;</span><span class=p>}}</span>
<span class=err>RESULT</span><span class=w> </span><span class=err>=</span><span class=w> </span><span class=p>{</span><span class=nt>&quot;NPExec&quot;</span><span class=p>:</span><span class=s2>&quot;Done&quot;</span><span class=p>}</span>
</code></pre></div> <div class="admonition example"> <p class=admonition-title>Example</p> <p>Modbus autorepeat on communication error</p> </div> <p>Read current autorepeat value:</p> <div class=highlight><pre><span></span><code><span class=err>NPO</span><span class=kc>n</span><span class=err>Error</span>
<span class=err>RESULT</span><span class=w> </span><span class=err>=</span><span class=w> </span><span class=p>{</span><span class=nt>&quot;NPOnError&quot;</span><span class=p>:</span><span class=mi>2</span><span class=p>}</span>
</code></pre></div> <p>Set autorepeat value to 3:</p> <div class=highlight><pre><span></span><code><span class=err>NPO</span><span class=kc>n</span><span class=err>Error</span><span class=w> </span><span class=mi>3</span>
<span class=err>RESULT</span><span class=w> </span><span class=err>=</span><span class=w> </span><span class=p>{</span><span class=nt>&quot;NPOnError&quot;</span><span class=p>:</span><span class=mi>3</span><span class=p>}</span>
</code></pre></div> <h2 id=enhancements>Enhancements<a class=headerlink href=#enhancements title="Permanent link">~</a></h2> <h3 id=daily-sync-device-to-tasmota-time>Daily sync device to Tasmota time<a class=headerlink href=#daily-sync-device-to-tasmota-time title="Permanent link">~</a></h3> <p>Since the NeoPool devices, without a WiFi module, have no way of synchronizing their internal clock with an external clock and, in addition, the accuracy of the internal clock leaves something to be desired, it makes sense to synchronize the clock with Tasmota once a day. Advantageously, we do this at night after a possible daylight saving time or normal time change.</p> <p>We use a rule that synchronizes the time and which is triggered by the Tasmota built-in timer (here we use timer 10):</p> <div class=highlight><pre><span></span><code><span class=kt>Rule2</span>
<span class=w>  </span><span class=kt>ON</span><span class=w> </span><span class=kt>Clock</span><span class=o>#</span><span class=kt>Timer</span><span class=ow>=</span><span class=mi>10</span><span class=w> </span><span class=kt>DO</span><span class=w> </span><span class=kt>NPTime</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=kt>ENDON</span>
</code></pre></div> <p>Activate it:</p> <div class=highlight><pre><span></span><code><span class=kt>Backlog</span><span class=w> </span><span class=kt>Rule2</span><span class=w> </span><span class=mi>4</span><span class=p>;</span><span class=kt>Rule2</span><span class=w> </span><span class=mi>1</span>
</code></pre></div> <p>Configure Tasmota "Timer 10" for your needs:</p> <p><img alt src=../_media/xsns_83_neopool_timer.png></p> <h3 id=esp82xx-add-buttons-for-filtration-and-light-control>ESP82xx: Add buttons for filtration and light control<a class=headerlink href=#esp82xx-add-buttons-for-filtration-and-light-control title="Permanent link">~</a></h3> <p>Add two dummy buttons to control the filtration pump and the light.</p> <p>First we define two dummy relay (which does not have any physical function) on two unused GPIO (here we use GPIO0 and GPIO4 where we define Tasmota Relay 1 and 2):</p> <div class=highlight><pre><span></span><code><span class=kt>Backlog</span><span class=w> </span><span class=kt>GPIO0</span><span class=w> </span><span class=mi>224</span><span class=p>;</span><span class=kt>GPIO4</span><span class=w> </span><span class=mi>225</span>
</code></pre></div> <p>Then we rename the buttons for better visibility:</p> <div class=highlight><pre><span></span><code><span class=kt>Backlog</span><span class=w> </span><span class=kt>WebButton1</span><span class=w> </span><span class=kt>Filtration</span><span class=p>;</span><span class=kt>WebButton2</span><span class=w> </span><span class=kt>Light</span>
</code></pre></div> <p>Now we have the WebGUI buttons like this:</p> <p><img alt src=../_media/xsns_83_neopool_ctrl.png></p> <p>but missing the functionality behind. For that we use <a href=../Rules/ >Rules</a> and connect the states for Tasmota Power, Neopool filtration and light:</p> <div class=highlight><pre><span></span><code><span class=kt>Rule1</span>
<span class=w>  </span><span class=kt>ON</span><span class=w> </span><span class=kt>Power1</span><span class=o>#</span><span class=kt>State</span><span class=o>==</span><span class=mi>0</span><span class=w> </span><span class=kt>DO</span><span class=w> </span><span class=kt>NPFiltration</span><span class=w> </span><span class=o>%</span><span class=n>value</span><span class=o>%</span><span class=w> </span><span class=kt>ENDON</span>
<span class=w>  </span><span class=kt>ON</span><span class=w> </span><span class=kt>Power1</span><span class=o>#</span><span class=kt>State</span><span class=o>==</span><span class=mi>1</span><span class=w> </span><span class=kt>DO</span><span class=w> </span><span class=kt>NPFiltration</span><span class=w> </span><span class=o>%</span><span class=n>value</span><span class=o>%</span><span class=w> </span><span class=kt>ENDON</span>
<span class=w>  </span><span class=kt>ON</span><span class=w> </span><span class=kt>NeoPool</span><span class=o>#</span><span class=kt>Filtration</span><span class=o>#</span><span class=kt>State</span><span class=o>==</span><span class=mi>0</span><span class=w> </span><span class=kt>DO</span><span class=w> </span><span class=kt>Power1</span><span class=w> </span><span class=o>%</span><span class=n>value</span><span class=o>%</span><span class=w> </span><span class=kt>ENDON</span>
<span class=w>  </span><span class=kt>ON</span><span class=w> </span><span class=kt>NeoPool</span><span class=o>#</span><span class=kt>Filtration</span><span class=o>#</span><span class=kt>State</span><span class=o>==</span><span class=mi>1</span><span class=w> </span><span class=kt>DO</span><span class=w> </span><span class=kt>Power1</span><span class=w> </span><span class=o>%</span><span class=n>value</span><span class=o>%</span><span class=w> </span><span class=kt>ENDON</span>
<span class=w>  </span><span class=kt>ON</span><span class=w> </span><span class=kt>Power2</span><span class=o>#</span><span class=kt>State</span><span class=o>==</span><span class=mi>0</span><span class=w> </span><span class=kt>DO</span><span class=w> </span><span class=kt>NPLight</span><span class=w> </span><span class=o>%</span><span class=n>value</span><span class=o>%</span><span class=w> </span><span class=kt>ENDON</span>
<span class=w>  </span><span class=kt>ON</span><span class=w> </span><span class=kt>Power2</span><span class=o>#</span><span class=kt>State</span><span class=o>==</span><span class=mi>1</span><span class=w> </span><span class=kt>DO</span><span class=w> </span><span class=kt>NPLight</span><span class=w> </span><span class=o>%</span><span class=n>value</span><span class=o>%</span><span class=w> </span><span class=kt>ENDON</span>
<span class=w>  </span><span class=kt>ON</span><span class=w> </span><span class=kt>NeoPool</span><span class=o>#</span><span class=kt>Light</span><span class=o>==</span><span class=mi>0</span><span class=w> </span><span class=kt>DO</span><span class=w> </span><span class=kt>Power2</span><span class=w> </span><span class=o>%</span><span class=n>value</span><span class=o>%</span><span class=w> </span><span class=kt>ENDON</span>
<span class=w>  </span><span class=kt>ON</span><span class=w> </span><span class=kt>NeoPool</span><span class=o>#</span><span class=kt>Light</span><span class=o>==</span><span class=mi>1</span><span class=w> </span><span class=kt>DO</span><span class=w> </span><span class=kt>Power2</span><span class=w> </span><span class=o>%</span><span class=n>value</span><span class=o>%</span><span class=w> </span><span class=kt>ENDON</span>
</code></pre></div> <p>Don't wonder about the double trigger definition, which at first glance seem nonsensical - they are necessary so that the rule does not trigger endless.</p> <p>At least we activate the rule:</p> <div class=highlight><pre><span></span><code><span class=kt>Backlog</span><span class=w> </span><span class=kt>Rule1</span><span class=w> </span><span class=mi>5</span><span class=p>;</span><span class=kt>Rule1</span><span class=w> </span><span class=mi>1</span>
</code></pre></div> <p>It is important to enable the Rule ONCE (<code>Rule1 5</code>) function, which prevents the trigger is triggering themself in a loop.</p> <p>You can now control filtration and light using the WebGUI and get the current status of the device elements when they are switched by auto-mode or manually on the device directly.</p> <p><img alt src=../_media/xsns_83_neopool_do_ctrl.png></p> <p>Additional advantage is that you can also use Tasmota Timer switching Power1 (=filtration) and Power2 (light) for your needs.</p> <h3 id=esp32-adding-user-defined-neopool-commands-to-tasmota>ESP32: Adding user defined NeoPool commands to Tasmota<a class=headerlink href=#esp32-adding-user-defined-neopool-commands-to-tasmota title="Permanent link">~</a></h3> <p>The following enhancements are made using the <a href=../Berry/ >Berry Scripting Language</a> which is available on ESP32 only.</p> <p>The class <code>NeoPoolCommands</code> below adds two new commands to Tasmota:</p> <table> <thead> <tr> <th align=left>Command</th> <th align=left>Parameters</th> </tr> </thead> <tbody> <tr> <td align=left>NPBoost<a id=NPBoost></a></td> <td align=left><code>{&lt;state&gt;}</code><br>get/set boost mode (state = <code>0..2</code>). Get if state is omitted, otherwise set accordingly <code>&lt;state&gt;</code>:<ul><li><code>0</code> - disable boost mode</li><li><code>1</code> - enable boost mode (without redox control)</li><li><code>2</code> - enable boost mode (with redox control)</li></ul></td> </tr> <tr> <td align=left>NPAux&lt;x><a id=NPAux></a></td> <td align=left><code>{&lt;state&gt;}</code><br>get/set auxiliary relay &lt;x> (state = <code>0..2</code>). Get if state is omitted, otherwise set accordingly <code>&lt;state&gt;</code>:<ul><li><code>0</code> - switch off auxiliary relay</li><li><code>1</code> - switch on auxiliary relay</li></ul></td> </tr> </tbody> </table> <p>The class members <code>NPBoost</code> and <code>NPAux</code> can also be used as templates for further commands.</p> <p>Store the following code into a Tasmota file by using the WebGUI "Console" / "Manage File system".</p> <h4 id=neopoolcmdbe>neopoolcmd.be<a class=headerlink href=#neopoolcmdbe title="Permanent link">~</a></h4> <div class=highlight><pre><span></span><code><span class=c1># File: neopoolcmd.be</span>
<span class=c1>#</span>
<span class=c1># Add new commands NPBoost and NPAux</span>

<span class=c1># Neopool definitions</span>
<span class=n>var</span> <span class=n>MBF_RELAY_STATE</span> <span class=o>=</span> <span class=mh>0x010E</span>
<span class=n>var</span> <span class=n>MBF_NOTIFICATION</span> <span class=o>=</span> <span class=mh>0x0110</span>
<span class=n>var</span> <span class=n>MBF_CELL_BOOST</span> <span class=o>=</span> <span class=mh>0x020C</span>

<span class=n>var</span> <span class=n>MBF_PAR_TIMER_BLOCK_AUX1_INT1</span> <span class=o>=</span> <span class=mh>0x04AC</span>
<span class=n>var</span> <span class=n>MBF_PAR_TIMER_BLOCK_AUX2_INT1</span> <span class=o>=</span> <span class=mh>0x04BB</span>
<span class=n>var</span> <span class=n>MBF_PAR_TIMER_BLOCK_AUX3_INT1</span> <span class=o>=</span> <span class=mh>0x04CA</span>
<span class=n>var</span> <span class=n>MBF_PAR_TIMER_BLOCK_AUX4_INT1</span> <span class=o>=</span> <span class=mh>0x04D9</span>
<span class=n>var</span> <span class=n>PAR_TIMER_BLOCK_AUX</span> <span class=o>=</span> <span class=p>[</span>
  <span class=n>MBF_PAR_TIMER_BLOCK_AUX1_INT1</span><span class=p>,</span>
  <span class=n>MBF_PAR_TIMER_BLOCK_AUX2_INT1</span><span class=p>,</span>
  <span class=n>MBF_PAR_TIMER_BLOCK_AUX3_INT1</span><span class=p>,</span>
  <span class=n>MBF_PAR_TIMER_BLOCK_AUX4_INT1</span>
<span class=p>]</span>
<span class=n>var</span> <span class=n>MBV_PAR_CTIMER_ALWAYS_ON</span>      <span class=o>=</span> <span class=mi>3</span>
<span class=n>var</span> <span class=n>MBV_PAR_CTIMER_ALWAYS_OFF</span>     <span class=o>=</span> <span class=mi>4</span>

<span class=c1># NeoPool command class</span>
<span class=k>class</span> <span class=nc>NeoPoolCommands</span>
  <span class=n>var</span> <span class=n>TEXT_OFF</span>
  <span class=n>var</span> <span class=n>TEXT_ON</span>
  <span class=n>var</span> <span class=n>TEXT_TOGGLE</span>

  <span class=c1># string helper</span>
  <span class=k>def</span> <span class=nf>ltrim</span><span class=p>(</span><span class=n>s</span><span class=p>)</span>
    <span class=kn>import</span> <span class=nn>string</span>
    <span class=n>var</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span> <span class=k>while</span><span class=p>(</span><span class=n>s</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>==</span><span class=s1>&#39; &#39;</span><span class=p>)</span> <span class=n>i</span> <span class=o>+=</span> <span class=mi>1</span> <span class=n>end</span>
    <span class=k>return</span> <span class=n>string</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=n>s</span><span class=p>,</span> <span class=n>i</span><span class=p>)[</span><span class=mi>1</span><span class=p>]</span>
  <span class=n>end</span>
  <span class=k>def</span> <span class=nf>rtrim</span><span class=p>(</span><span class=n>s</span><span class=p>)</span>
    <span class=kn>import</span> <span class=nn>string</span>
    <span class=k>return</span> <span class=n>string</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=n>s</span><span class=p>,</span> <span class=s2>&quot; &quot;</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
  <span class=n>end</span>
  <span class=k>def</span> <span class=nf>trim</span><span class=p>(</span><span class=n>s</span><span class=p>)</span>
    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>rtrim</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ltrim</span><span class=p>(</span><span class=n>s</span><span class=p>));</span>
  <span class=n>end</span>

  <span class=c1># NPBoost OFF|0|ON|1|REDOX|2</span>
  <span class=c1>#   0|OFF:   Switch boost off</span>
  <span class=c1>#   1|ON:    Switch boost on without redox control</span>
  <span class=c1>#   2|REDOX: Switch boost on with redox control</span>
  <span class=k>def</span> <span class=nf>NPBoost</span><span class=p>(</span><span class=n>cmd</span><span class=p>,</span> <span class=n>idx</span><span class=p>,</span> <span class=n>payload</span><span class=p>)</span>
    <span class=kn>import</span> <span class=nn>string</span>
    <span class=n>var</span> <span class=n>ctrl</span><span class=p>,</span> <span class=n>parm</span>

    <span class=k>try</span>
      <span class=n>parm</span> <span class=o>=</span> <span class=n>string</span><span class=o>.</span><span class=n>toupper</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>trim</span><span class=p>(</span><span class=n>payload</span><span class=p>))</span>
    <span class=k>except</span> <span class=o>..</span>
      <span class=n>parm</span> <span class=o>=</span> <span class=s2>&quot;&quot;</span>
    <span class=n>end</span>
    <span class=k>if</span> <span class=n>parm</span> <span class=o>!=</span> <span class=s2>&quot;&quot;</span>
      <span class=k>if</span> <span class=n>string</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=n>parm</span><span class=p>,</span> <span class=s1>&#39;OFF&#39;</span><span class=p>)</span><span class=o>&gt;=</span><span class=mi>0</span> <span class=o>||</span> <span class=n>string</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=n>parm</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>TEXT_OFF</span><span class=p>)</span><span class=o>&gt;=</span><span class=mi>0</span> <span class=o>||</span> <span class=n>string</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=n>parm</span><span class=p>,</span> <span class=s1>&#39;0&#39;</span><span class=p>)</span><span class=o>&gt;=</span><span class=mi>0</span>
        <span class=n>ctrl</span> <span class=o>=</span> <span class=mi>0</span>
      <span class=k>elif</span> <span class=n>string</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=n>parm</span><span class=p>,</span> <span class=s1>&#39;ON&#39;</span><span class=p>)</span><span class=o>&gt;=</span><span class=mi>0</span> <span class=o>||</span> <span class=n>string</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=n>parm</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>TEXT_ON</span><span class=p>)</span><span class=o>&gt;=</span><span class=mi>0</span> <span class=o>||</span> <span class=n>string</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=n>parm</span><span class=p>,</span> <span class=s1>&#39;1&#39;</span><span class=p>)</span><span class=o>&gt;=</span><span class=mi>0</span>
        <span class=n>ctrl</span> <span class=o>=</span> <span class=mh>0x85A0</span>
      <span class=k>elif</span> <span class=n>string</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=n>parm</span><span class=p>,</span> <span class=s1>&#39;REDOX&#39;</span><span class=p>)</span><span class=o>&gt;=</span><span class=mi>0</span> <span class=o>||</span> <span class=n>string</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=n>parm</span><span class=p>,</span> <span class=s1>&#39;2&#39;</span><span class=p>)</span><span class=o>&gt;=</span><span class=mi>0</span>
        <span class=n>ctrl</span> <span class=o>=</span> <span class=mh>0x05A0</span>
      <span class=k>else</span>
        <span class=n>tasmota</span><span class=o>.</span><span class=n>resp_cmnd_error</span><span class=p>()</span>
        <span class=k>return</span>
      <span class=n>end</span>
      <span class=n>tasmota</span><span class=o>.</span><span class=n>cmd</span><span class=p>(</span><span class=n>string</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=s2>&quot;NPWrite 0x</span><span class=si>%04X</span><span class=s2>,0x</span><span class=si>%04X</span><span class=s2>&quot;</span><span class=p>,</span> <span class=n>MBF_CELL_BOOST</span><span class=p>,</span> <span class=n>ctrl</span><span class=p>))</span>
      <span class=n>tasmota</span><span class=o>.</span><span class=n>cmd</span><span class=p>(</span><span class=s2>&quot;NPSave&quot;</span><span class=p>)</span>
      <span class=n>tasmota</span><span class=o>.</span><span class=n>cmd</span><span class=p>(</span><span class=s2>&quot;NPExec&quot;</span><span class=p>)</span>
      <span class=n>tasmota</span><span class=o>.</span><span class=n>cmd</span><span class=p>(</span><span class=n>string</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=s2>&quot;NPWrite 0x</span><span class=si>%04X</span><span class=s2>,0x7F&quot;</span><span class=p>,</span> <span class=n>MBF_NOTIFICATION</span><span class=p>))</span>
    <span class=k>else</span>
      <span class=k>try</span>
        <span class=n>ctrl</span> <span class=o>=</span> <span class=nb>compile</span><span class=p>(</span><span class=s2>&quot;return &quot;</span><span class=o>..</span><span class=n>tasmota</span><span class=o>.</span><span class=n>cmd</span><span class=p>(</span><span class=n>string</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=s2>&quot;NPRead 0x</span><span class=si>%04X</span><span class=s2>&quot;</span><span class=p>,</span> <span class=n>MBF_CELL_BOOST</span><span class=p>))[</span><span class=s1>&#39;NPRead&#39;</span><span class=p>][</span><span class=s1>&#39;Data&#39;</span><span class=p>])()</span>
      <span class=k>except</span> <span class=o>..</span>
        <span class=n>tasmota</span><span class=o>.</span><span class=n>resp_cmnd_error</span><span class=p>()</span>
        <span class=k>return</span>
      <span class=n>end</span>
    <span class=n>end</span>
    <span class=n>tasmota</span><span class=o>.</span><span class=n>resp_cmnd</span><span class=p>(</span><span class=n>string</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=s1>&#39;{&quot;</span><span class=si>%s</span><span class=s1>&quot;:&quot;</span><span class=si>%s</span><span class=s1>&quot;}&#39;</span><span class=p>,</span> <span class=n>cmd</span><span class=p>,</span> <span class=n>ctrl</span> <span class=o>==</span> <span class=mi>0</span> <span class=err>?</span> <span class=bp>self</span><span class=o>.</span><span class=n>TEXT_OFF</span> <span class=p>:</span> <span class=p>(</span><span class=n>ctrl</span> <span class=o>&amp;</span> <span class=mh>0x8500</span><span class=p>)</span> <span class=o>==</span> <span class=mh>0x8500</span> <span class=err>?</span> <span class=bp>self</span><span class=o>.</span><span class=n>TEXT_ON</span> <span class=p>:</span> <span class=s2>&quot;REDOX&quot;</span><span class=p>))</span>
  <span class=n>end</span>

  <span class=c1># NPAux&lt;x&gt; OFF|0|ON|1 t (&lt;x&gt; = 1..4)</span>
  <span class=c1>#   0|OFF:    Switch Aux x to off</span>
  <span class=c1>#   1|ON:     Switch Aux x to on</span>
  <span class=c1>#   2|TOGGLE: Toggle Aux x</span>
  <span class=k>def</span> <span class=nf>NPAux</span><span class=p>(</span><span class=n>cmd</span><span class=p>,</span> <span class=n>idx</span><span class=p>,</span> <span class=n>payload</span><span class=p>)</span>
    <span class=kn>import</span> <span class=nn>string</span>
    <span class=n>var</span> <span class=n>ctrl</span><span class=p>,</span> <span class=n>parm</span>

    <span class=k>if</span> <span class=n>idx</span> <span class=o>&lt;</span> <span class=mi>1</span> <span class=o>||</span> <span class=n>idx</span> <span class=o>&gt;</span> <span class=mi>4</span>
      <span class=n>tasmota</span><span class=o>.</span><span class=n>resp_cmnd_error</span><span class=p>()</span>
      <span class=k>return</span>
    <span class=n>end</span>

    <span class=k>try</span>
      <span class=n>parm</span> <span class=o>=</span> <span class=n>string</span><span class=o>.</span><span class=n>toupper</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>trim</span><span class=p>(</span><span class=n>payload</span><span class=p>))</span>
    <span class=k>except</span> <span class=o>..</span>
      <span class=n>parm</span> <span class=o>=</span> <span class=s2>&quot;&quot;</span>
    <span class=n>end</span>
    <span class=k>if</span> <span class=n>parm</span> <span class=o>!=</span> <span class=s2>&quot;&quot;</span>
      <span class=k>if</span> <span class=n>string</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=n>parm</span><span class=p>,</span> <span class=s1>&#39;OFF&#39;</span><span class=p>)</span><span class=o>&gt;=</span><span class=mi>0</span> <span class=o>||</span> <span class=n>string</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=n>parm</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>TEXT_OFF</span><span class=p>)</span><span class=o>&gt;=</span><span class=mi>0</span> <span class=o>||</span> <span class=n>string</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=n>parm</span><span class=p>,</span> <span class=s1>&#39;0&#39;</span><span class=p>)</span><span class=o>&gt;=</span><span class=mi>0</span>
        <span class=n>ctrl</span> <span class=o>=</span> <span class=n>MBV_PAR_CTIMER_ALWAYS_OFF</span>
      <span class=k>elif</span> <span class=n>string</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=n>parm</span><span class=p>,</span> <span class=s1>&#39;ON&#39;</span><span class=p>)</span><span class=o>&gt;=</span><span class=mi>0</span> <span class=o>||</span> <span class=n>string</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=n>parm</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>TEXT_ON</span><span class=p>)</span><span class=o>&gt;=</span><span class=mi>0</span> <span class=o>||</span> <span class=n>string</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=n>parm</span><span class=p>,</span> <span class=s1>&#39;1&#39;</span><span class=p>)</span><span class=o>&gt;=</span><span class=mi>0</span>
        <span class=n>ctrl</span> <span class=o>=</span> <span class=n>MBV_PAR_CTIMER_ALWAYS_ON</span>
      <span class=k>elif</span> <span class=n>string</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=n>parm</span><span class=p>,</span> <span class=s1>&#39;TOGGLE&#39;</span><span class=p>)</span><span class=o>&gt;=</span><span class=mi>0</span> <span class=o>||</span> <span class=n>string</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=n>parm</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>TEXT_TOGGLE</span><span class=p>)</span><span class=o>&gt;=</span><span class=mi>0</span> <span class=o>||</span> <span class=n>string</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=n>parm</span><span class=p>,</span> <span class=s1>&#39;2&#39;</span><span class=p>)</span><span class=o>&gt;=</span><span class=mi>0</span>
        <span class=k>try</span>
          <span class=n>ctrl</span> <span class=o>=</span> <span class=p>(</span><span class=nb>compile</span><span class=p>(</span><span class=s2>&quot;return &quot;</span><span class=o>..</span><span class=n>tasmota</span><span class=o>.</span><span class=n>cmd</span><span class=p>(</span><span class=n>string</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=s2>&quot;NPRead 0x</span><span class=si>%04X</span><span class=s2>&quot;</span><span class=p>,</span> <span class=n>MBF_RELAY_STATE</span><span class=p>))[</span><span class=s1>&#39;NPRead&#39;</span><span class=p>][</span><span class=s1>&#39;Data&#39;</span><span class=p>])()</span> <span class=o>&gt;&gt;</span> <span class=p>(</span><span class=n>idx</span><span class=o>+</span><span class=mi>2</span><span class=p>))</span> <span class=o>&amp;</span> <span class=mi>1</span> <span class=err>?</span> <span class=n>MBV_PAR_CTIMER_ALWAYS_OFF</span> <span class=p>:</span> <span class=n>MBV_PAR_CTIMER_ALWAYS_ON</span>
        <span class=k>except</span> <span class=o>..</span>
          <span class=n>tasmota</span><span class=o>.</span><span class=n>resp_cmnd_error</span><span class=p>()</span>
          <span class=k>return</span>
        <span class=n>end</span>
      <span class=k>else</span>
        <span class=n>tasmota</span><span class=o>.</span><span class=n>resp_cmnd_error</span><span class=p>()</span>
        <span class=k>return</span>
      <span class=n>end</span>
      <span class=n>tasmota</span><span class=o>.</span><span class=n>cmd</span><span class=p>(</span><span class=n>string</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=s2>&quot;NPWrite 0x</span><span class=si>%04X</span><span class=s2>,</span><span class=si>%d</span><span class=s2>&quot;</span><span class=p>,</span> <span class=n>PAR_TIMER_BLOCK_AUX</span><span class=p>[</span><span class=n>idx</span><span class=o>-</span><span class=mi>1</span><span class=p>],</span> <span class=n>ctrl</span><span class=p>))</span>
      <span class=n>tasmota</span><span class=o>.</span><span class=n>cmd</span><span class=p>(</span><span class=s2>&quot;NPExec&quot;</span><span class=p>)</span>
    <span class=k>else</span>
      <span class=k>try</span>
        <span class=n>ctrl</span> <span class=o>=</span> <span class=p>(</span><span class=nb>compile</span><span class=p>(</span><span class=s2>&quot;return &quot;</span><span class=o>..</span><span class=n>tasmota</span><span class=o>.</span><span class=n>cmd</span><span class=p>(</span><span class=n>string</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=s2>&quot;NPRead 0x</span><span class=si>%04X</span><span class=s2>&quot;</span><span class=p>,</span> <span class=n>MBF_RELAY_STATE</span><span class=p>))[</span><span class=s1>&#39;NPRead&#39;</span><span class=p>][</span><span class=s1>&#39;Data&#39;</span><span class=p>])()</span> <span class=o>&gt;&gt;</span> <span class=p>(</span><span class=n>idx</span><span class=o>+</span><span class=mi>2</span><span class=p>))</span> <span class=o>&amp;</span> <span class=mi>1</span>
      <span class=k>except</span> <span class=o>..</span>
        <span class=n>tasmota</span><span class=o>.</span><span class=n>resp_cmnd_error</span><span class=p>()</span>
        <span class=k>return</span>
      <span class=n>end</span>
    <span class=n>end</span>
  <span class=n>end</span>

  <span class=k>def</span> <span class=nf>init</span><span class=p>()</span>
    <span class=c1># get tasmota settings</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>TEXT_OFF</span> <span class=o>=</span> <span class=n>tasmota</span><span class=o>.</span><span class=n>cmd</span><span class=p>(</span><span class=s2>&quot;StateText1&quot;</span><span class=p>)[</span><span class=s1>&#39;StateText1&#39;</span><span class=p>]</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>TEXT_ON</span> <span class=o>=</span> <span class=n>tasmota</span><span class=o>.</span><span class=n>cmd</span><span class=p>(</span><span class=s2>&quot;StateText2&quot;</span><span class=p>)[</span><span class=s1>&#39;StateText2&#39;</span><span class=p>]</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>TEXT_TOGGLE</span> <span class=o>=</span> <span class=n>tasmota</span><span class=o>.</span><span class=n>cmd</span><span class=p>(</span><span class=s2>&quot;StateText3&quot;</span><span class=p>)[</span><span class=s1>&#39;StateText3&#39;</span><span class=p>]</span>
    <span class=c1># add commands</span>
    <span class=n>tasmota</span><span class=o>.</span><span class=n>add_cmd</span><span class=p>(</span><span class=s1>&#39;NPBoost&#39;</span><span class=p>,</span> <span class=o>/</span> <span class=n>cmd</span><span class=p>,</span> <span class=n>idx</span><span class=p>,</span> <span class=n>payload</span> <span class=o>-&gt;</span> <span class=bp>self</span><span class=o>.</span><span class=n>NPBoost</span><span class=p>(</span><span class=n>cmd</span><span class=p>,</span> <span class=n>idx</span><span class=p>,</span> <span class=n>payload</span><span class=p>))</span>
    <span class=n>tasmota</span><span class=o>.</span><span class=n>add_cmd</span><span class=p>(</span><span class=s1>&#39;NPAux&#39;</span><span class=p>,</span> <span class=o>/</span> <span class=n>cmd</span><span class=p>,</span> <span class=n>idx</span><span class=p>,</span> <span class=n>payload</span> <span class=o>-&gt;</span> <span class=bp>self</span><span class=o>.</span><span class=n>NPAux</span><span class=p>(</span><span class=n>cmd</span><span class=p>,</span> <span class=n>idx</span><span class=p>,</span> <span class=n>payload</span><span class=p>))</span>
  <span class=n>end</span>

  <span class=k>def</span> <span class=nf>deinit</span><span class=p>()</span>
    <span class=c1># remove commands</span>
    <span class=n>tasmota</span><span class=o>.</span><span class=n>remove_cmd</span><span class=p>(</span><span class=s1>&#39;NPBoost&#39;</span><span class=p>)</span>
    <span class=n>tasmota</span><span class=o>.</span><span class=n>remove_cmd</span><span class=p>(</span><span class=s1>&#39;NPAux&#39;</span><span class=p>)</span>
  <span class=n>end</span>
<span class=n>end</span>
<span class=n>neopoolcommands</span> <span class=o>=</span> <span class=n>NeoPoolCommands</span><span class=p>()</span>
</code></pre></div> <p>To activate the new commands, go to WebGUI "Consoles" / "Berry Scripting console" and execute</p> <div class=highlight><pre><span></span><code><span class=n>load</span><span class=p>(</span><span class=s2>&quot;neopoolcmd.be&quot;</span><span class=p>)</span>
</code></pre></div> <h3 id=esp32-add-gui-controls-for-filtration-light-and-aux-relais>ESP32: Add GUI controls for filtration, light and aux relais<a class=headerlink href=#esp32-add-gui-controls-for-filtration-light-and-aux-relais title="Permanent link">~</a></h3> <p>The following enhancements are made using the <a href=../Berry/ >Berry Scripting Language</a> which is available on ESP32 only.</p> <p>The class <code>NeoPoolButtonMethods</code> below adds new GUI elements to control filtration, light and aux relais:</p> <p><img alt src=../_media/xsns_83_neopool_gui.png></p> <p>Store the following code into a Tasmota file by using the WebGUI "Console" / "Manage File system".</p> <h4 id=neopoolguibe>neopoolgui.be<a class=headerlink href=#neopoolguibe title="Permanent link">~</a></h4> <div class=highlight><pre><span></span><code><span class=c1># File: neopoolgui.be</span>
<span class=c1>#</span>
<span class=c1># Add GUI elements for filtration control, light and aux relais</span>

<span class=kn>import</span> <span class=nn>webserver</span>
<span class=kn>import</span> <span class=nn>string</span>

<span class=k>class</span> <span class=nc>NeoPoolButtonMethods</span> <span class=p>:</span> <span class=n>Driver</span>

  <span class=c1>#- method for adding elements to the main menu -#</span>
  <span class=k>def</span> <span class=nf>web_add_main_button</span><span class=p>()</span>

    <span class=k>def</span> <span class=nf>selected</span><span class=p>(</span><span class=n>value</span><span class=p>,</span> <span class=n>comp</span><span class=p>)</span>
      <span class=k>return</span> <span class=n>comp</span> <span class=o>==</span> <span class=n>value</span> <span class=err>?</span> <span class=s1>&#39;selected=&quot;&quot;&#39;</span> <span class=p>:</span> <span class=s1>&#39;&#39;</span>
    <span class=n>end</span>

    <span class=n>var</span> <span class=n>speed</span> <span class=o>=</span> <span class=n>tasmota</span><span class=o>.</span><span class=n>cmd</span><span class=p>(</span><span class=s1>&#39;NPFiltration&#39;</span><span class=p>)[</span><span class=s1>&#39;Speed&#39;</span><span class=p>]</span>
    <span class=n>var</span> <span class=n>mode</span> <span class=o>=</span> <span class=n>tasmota</span><span class=o>.</span><span class=n>cmd</span><span class=p>(</span><span class=s1>&#39;NPFiltrationmode&#39;</span><span class=p>)[</span><span class=s1>&#39;NPFiltrationmode&#39;</span><span class=p>]</span>

    <span class=n>var</span> <span class=n>html</span> <span class=o>=</span> <span class=s1>&#39;&lt;p&gt;&lt;/p&gt;&#39;</span>

    <span class=c1># Filtration mode/speed</span>
    <span class=n>html</span><span class=o>+=</span> <span class=s1>&#39;&lt;table style=&quot;width:100%&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&#39;</span>
    <span class=n>html</span><span class=o>+=</span> <span class=s1>&#39;  &lt;td style=&quot;width:50%;padding: 0 4px 0 4px;&quot;&gt;&#39;</span>
    <span class=n>html</span><span class=o>+=</span> <span class=s1>&#39;    &lt;label for=&quot;mode&quot;&gt;&lt;small&gt;Mode:&lt;/small&gt;&lt;/label&gt;&#39;</span>
    <span class=n>html</span><span class=o>+=</span> <span class=s1>&#39;    &lt;select id=&quot;mode&quot; name=&quot;mode&quot;&gt;&#39;</span>
    <span class=n>html</span><span class=o>+=</span> <span class=n>string</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=s1>&#39;&lt;option value=&quot;m_sv_manual&quot;</span><span class=si>%s</span><span class=s1>&gt;Manual&lt;/option&gt;&#39;</span><span class=p>,</span> <span class=n>selected</span><span class=p>(</span><span class=n>mode</span><span class=p>,</span> <span class=s1>&#39;Manual&#39;</span><span class=p>))</span>
    <span class=n>html</span><span class=o>+=</span> <span class=n>string</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=s1>&#39;&lt;option value=&quot;m_sv_auto&quot;</span><span class=si>%s</span><span class=s1>&gt;Auto&lt;/option&gt;&#39;</span><span class=p>,</span> <span class=n>selected</span><span class=p>(</span><span class=n>mode</span><span class=p>,</span> <span class=s1>&#39;Auto&#39;</span><span class=p>))</span>
    <span class=n>html</span><span class=o>+=</span> <span class=n>string</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=s1>&#39;&lt;option value=&quot;m_sv_heating&quot;</span><span class=si>%s</span><span class=s1>&gt;Heating&lt;/option&gt;&#39;</span><span class=p>,</span> <span class=n>selected</span><span class=p>(</span><span class=n>mode</span><span class=p>,</span> <span class=s1>&#39;Heating&#39;</span><span class=p>))</span>
    <span class=n>html</span><span class=o>+=</span> <span class=n>string</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=s1>&#39;&lt;option value=&quot;m_sv_smart&quot;</span><span class=si>%s</span><span class=s1>&gt;Smart&lt;/option&gt;&#39;</span><span class=p>,</span> <span class=n>selected</span><span class=p>(</span><span class=n>mode</span><span class=p>,</span> <span class=s1>&#39;Smart&#39;</span><span class=p>))</span>
    <span class=n>html</span><span class=o>+=</span> <span class=n>string</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=s1>&#39;&lt;option value=&quot;m_sv_intelligent&quot;</span><span class=si>%s</span><span class=s1>&gt;Intelligent&lt;/option&gt;&#39;</span><span class=p>,</span> <span class=n>selected</span><span class=p>(</span><span class=n>mode</span><span class=p>,</span> <span class=s1>&#39;Intelligent&#39;</span><span class=p>))</span>
    <span class=n>html</span><span class=o>+=</span> <span class=s1>&#39;    &lt;/select&gt;&#39;</span>
    <span class=n>html</span><span class=o>+=</span> <span class=s1>&#39;  &lt;/td&gt;&#39;</span>
    <span class=n>html</span><span class=o>+=</span> <span class=s1>&#39;  &lt;td style=&quot;width:50%;padding: 0 4px 0 4px;&quot;&gt;&#39;</span>
    <span class=n>html</span><span class=o>+=</span> <span class=s1>&#39;    &lt;label for=&quot;speed&quot;&gt;&lt;small&gt;Speed:&lt;/label&gt;&#39;</span>
    <span class=n>html</span><span class=o>+=</span> <span class=s1>&#39;    &lt;select id=&quot;speed&quot; name=&quot;speed&quot;&gt;&#39;</span>
    <span class=n>html</span><span class=o>+=</span> <span class=n>string</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=s1>&#39;&lt;option value=&quot;m_sv_slow&quot;</span><span class=si>%s</span><span class=s1>&gt;Slow&lt;/option&gt;&#39;</span><span class=p>,</span> <span class=n>selected</span><span class=p>(</span><span class=n>speed</span><span class=p>,</span> <span class=s1>&#39;1&#39;</span><span class=p>))</span>
    <span class=n>html</span><span class=o>+=</span> <span class=n>string</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=s1>&#39;&lt;option value=&quot;m_sv_medium&quot;</span><span class=si>%s</span><span class=s1>&gt;Medium&lt;/option&gt;&#39;</span><span class=p>,</span> <span class=n>selected</span><span class=p>(</span><span class=n>speed</span><span class=p>,</span> <span class=s1>&#39;2&#39;</span><span class=p>))</span>
    <span class=n>html</span><span class=o>+=</span> <span class=n>string</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=s1>&#39;&lt;option value=&quot;m_sv_fast&quot;</span><span class=si>%s</span><span class=s1>&gt;Fast&lt;/option&gt;&#39;</span><span class=p>,</span> <span class=n>selected</span><span class=p>(</span><span class=n>speed</span><span class=p>,</span> <span class=s1>&#39;3&#39;</span><span class=p>))</span>
    <span class=n>html</span><span class=o>+=</span> <span class=s1>&#39;    &lt;/select&gt;&#39;</span>
    <span class=n>html</span><span class=o>+=</span> <span class=s1>&#39;  &lt;/td&gt;&#39;</span>
    <span class=n>html</span><span class=o>+=</span> <span class=s1>&#39;&lt;/tr&gt;&lt;tr&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&#39;</span>
    <span class=n>html</span><span class=o>+=</span> <span class=s1>&#39;&lt;script&gt;&#39;</span>
    <span class=n>html</span><span class=o>+=</span> <span class=s1>&#39;document.getElementById(&quot;speed&quot;).addEventListener (&quot;change&quot;,function(){la(&quot;&amp;&quot;+this.value+&quot;=1&quot;);});&#39;</span>
    <span class=n>html</span><span class=o>+=</span> <span class=s1>&#39;document.getElementById(&quot;mode&quot;).addEventListener (&quot;change&quot;,function(){la(&quot;&amp;&quot;+this.value+&quot;=1&quot;);});&#39;</span>
    <span class=n>html</span><span class=o>+=</span> <span class=s1>&#39;&lt;/script&gt;&#39;</span>

    <span class=c1># Filtration button</span>
    <span class=n>html</span><span class=o>+=</span> <span class=s1>&#39;&lt;table style=&quot;width:100%&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&#39;</span>
    <span class=n>html</span><span class=o>+=</span> <span class=s1>&#39;  &lt;td style=&quot;width:100%&quot;&gt;&#39;</span>
    <span class=n>html</span><span class=o>+=</span> <span class=s1>&#39;    &lt;button id=&quot;bn_filtration&quot; name=&quot;bn_filtration&quot; onclick=&quot;la(</span><span class=se>\&#39;</span><span class=s1>&amp;m_sv_filtration=1</span><span class=se>\&#39;</span><span class=s1>);&quot;&gt;Filtration&lt;/button&gt;&#39;</span>
    <span class=n>html</span><span class=o>+=</span> <span class=s1>&#39;  &lt;/td&gt;&#39;</span>
    <span class=n>html</span><span class=o>+=</span> <span class=s1>&#39;&lt;/tr&gt;&lt;tr&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&#39;</span>

    <span class=c1># Light button</span>
    <span class=n>html</span><span class=o>+=</span> <span class=s1>&#39;&lt;table style=&quot;width:100%&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&#39;</span>
    <span class=n>html</span><span class=o>+=</span> <span class=s1>&#39;  &lt;td style=&quot;width:100%&quot;&gt;&#39;</span>
    <span class=n>html</span><span class=o>+=</span> <span class=s1>&#39;    &lt;button onclick=&quot;la(</span><span class=se>\&#39;</span><span class=s1>&amp;m_sv_light=1</span><span class=se>\&#39;</span><span class=s1>);&quot;&gt;Light&lt;/button&gt;&#39;</span>
    <span class=n>html</span><span class=o>+=</span> <span class=s1>&#39;  &lt;/td&gt;&#39;</span>
    <span class=n>html</span><span class=o>+=</span> <span class=s1>&#39;&lt;/tr&gt;&lt;tr&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&#39;</span>

    <span class=c1># Aux buttons</span>
    <span class=n>html</span><span class=o>+=</span> <span class=s1>&#39;&lt;table style=&quot;width:100%&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&#39;</span>
    <span class=n>html</span><span class=o>+=</span> <span class=s1>&#39;  &lt;td style=&quot;width:25%&quot;&gt;&lt;button onclick=&quot;la(</span><span class=se>\&#39;</span><span class=s1>&amp;m_sv_aux=1</span><span class=se>\&#39;</span><span class=s1>);&quot;&gt;Aux1&lt;/button&gt;&lt;/td&gt;&#39;</span>
    <span class=n>html</span><span class=o>+=</span> <span class=s1>&#39;  &lt;td style=&quot;width:25%&quot;&gt;&lt;button onclick=&quot;la(</span><span class=se>\&#39;</span><span class=s1>&amp;m_sv_aux=2</span><span class=se>\&#39;</span><span class=s1>);&quot;&gt;Aux2&lt;/button&gt;&lt;/td&gt;&#39;</span>
    <span class=n>html</span><span class=o>+=</span> <span class=s1>&#39;  &lt;td style=&quot;width:25%&quot;&gt;&lt;button onclick=&quot;la(</span><span class=se>\&#39;</span><span class=s1>&amp;m_sv_aux=3</span><span class=se>\&#39;</span><span class=s1>);&quot;&gt;Aux3&lt;/button&gt;&lt;/td&gt;&#39;</span>
    <span class=n>html</span><span class=o>+=</span> <span class=s1>&#39;  &lt;td style=&quot;width:25%&quot;&gt;&lt;button onclick=&quot;la(</span><span class=se>\&#39;</span><span class=s1>&amp;m_sv_aux=4</span><span class=se>\&#39;</span><span class=s1>);&quot;&gt;Aux4&lt;/button&gt;&lt;/td&gt;&#39;</span>
    <span class=n>html</span><span class=o>+=</span> <span class=s1>&#39;&lt;/tr&gt;&lt;tr&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&#39;</span>

    <span class=n>webserver</span><span class=o>.</span><span class=n>content_send</span><span class=p>(</span><span class=n>html</span><span class=p>)</span>
    <span class=n>html</span> <span class=o>=</span> <span class=n>nil</span>
    <span class=n>tasmota</span><span class=o>.</span><span class=n>gc</span><span class=p>()</span>
  <span class=n>end</span>

  <span class=c1>#- As we can add only one sensor method we will have to combine them besides all other sensor readings in one method -#</span>
  <span class=k>def</span> <span class=nf>web_sensor</span><span class=p>()</span>
    <span class=k>if</span> <span class=n>webserver</span><span class=o>.</span><span class=n>has_arg</span><span class=p>(</span><span class=s2>&quot;m_sv_filtration&quot;</span><span class=p>)</span>
      <span class=n>tasmota</span><span class=o>.</span><span class=n>cmd</span><span class=p>(</span><span class=s2>&quot;NPFiltration 2&quot;</span><span class=p>)</span>
    <span class=n>end</span>

    <span class=k>if</span> <span class=n>webserver</span><span class=o>.</span><span class=n>has_arg</span><span class=p>(</span><span class=s2>&quot;m_sv_slow&quot;</span><span class=p>)</span>
      <span class=n>tasmota</span><span class=o>.</span><span class=n>cmd</span><span class=p>(</span><span class=s2>&quot;NPFiltration 1,1&quot;</span><span class=p>)</span>
    <span class=n>end</span>
    <span class=k>if</span> <span class=n>webserver</span><span class=o>.</span><span class=n>has_arg</span><span class=p>(</span><span class=s2>&quot;m_sv_medium&quot;</span><span class=p>)</span>
      <span class=n>tasmota</span><span class=o>.</span><span class=n>cmd</span><span class=p>(</span><span class=s2>&quot;NPFiltration 1,2&quot;</span><span class=p>)</span>
    <span class=n>end</span>
    <span class=k>if</span> <span class=n>webserver</span><span class=o>.</span><span class=n>has_arg</span><span class=p>(</span><span class=s2>&quot;m_sv_fast&quot;</span><span class=p>)</span>
      <span class=n>tasmota</span><span class=o>.</span><span class=n>cmd</span><span class=p>(</span><span class=s2>&quot;NPFiltration 1,3&quot;</span><span class=p>)</span>
    <span class=n>end</span>

    <span class=k>if</span> <span class=n>webserver</span><span class=o>.</span><span class=n>has_arg</span><span class=p>(</span><span class=s2>&quot;m_sv_manual&quot;</span><span class=p>)</span>
      <span class=n>tasmota</span><span class=o>.</span><span class=n>cmd</span><span class=p>(</span><span class=s2>&quot;NPFiltrationmode 0&quot;</span><span class=p>)</span>
    <span class=n>end</span>
    <span class=k>if</span> <span class=n>webserver</span><span class=o>.</span><span class=n>has_arg</span><span class=p>(</span><span class=s2>&quot;m_sv_auto&quot;</span><span class=p>)</span>
      <span class=n>tasmota</span><span class=o>.</span><span class=n>cmd</span><span class=p>(</span><span class=s2>&quot;NPFiltrationmode 1&quot;</span><span class=p>)</span>
    <span class=n>end</span>
    <span class=k>if</span> <span class=n>webserver</span><span class=o>.</span><span class=n>has_arg</span><span class=p>(</span><span class=s2>&quot;m_sv_heating&quot;</span><span class=p>)</span>
      <span class=n>tasmota</span><span class=o>.</span><span class=n>cmd</span><span class=p>(</span><span class=s2>&quot;NPFiltrationmode 2&quot;</span><span class=p>)</span>
    <span class=n>end</span>
    <span class=k>if</span> <span class=n>webserver</span><span class=o>.</span><span class=n>has_arg</span><span class=p>(</span><span class=s2>&quot;m_sv_smart&quot;</span><span class=p>)</span>
      <span class=n>tasmota</span><span class=o>.</span><span class=n>cmd</span><span class=p>(</span><span class=s2>&quot;NPFiltrationmode 3&quot;</span><span class=p>)</span>
    <span class=n>end</span>
    <span class=k>if</span> <span class=n>webserver</span><span class=o>.</span><span class=n>has_arg</span><span class=p>(</span><span class=s2>&quot;m_sv_intelligent&quot;</span><span class=p>)</span>
      <span class=n>tasmota</span><span class=o>.</span><span class=n>cmd</span><span class=p>(</span><span class=s2>&quot;NPFiltrationmode 4&quot;</span><span class=p>)</span>
    <span class=n>end</span>

    <span class=k>if</span> <span class=n>webserver</span><span class=o>.</span><span class=n>has_arg</span><span class=p>(</span><span class=s2>&quot;m_sv_light&quot;</span><span class=p>)</span>
      <span class=n>tasmota</span><span class=o>.</span><span class=n>cmd</span><span class=p>(</span><span class=s2>&quot;NPLight 2&quot;</span><span class=p>)</span>
    <span class=n>end</span>

    <span class=k>if</span> <span class=n>webserver</span><span class=o>.</span><span class=n>has_arg</span><span class=p>(</span><span class=s2>&quot;m_sv_aux&quot;</span><span class=p>)</span>
      <span class=n>tasmota</span><span class=o>.</span><span class=n>cmd</span><span class=p>(</span><span class=s2>&quot;NPAux&quot;</span><span class=o>+</span><span class=n>webserver</span><span class=o>.</span><span class=n>arg</span><span class=p>(</span><span class=s2>&quot;m_sv_aux&quot;</span><span class=p>)</span><span class=o>+</span><span class=s2>&quot; TOGGLE&quot;</span><span class=p>)</span>
    <span class=n>end</span>
  <span class=n>end</span>

  <span class=k>def</span> <span class=nf>init</span><span class=p>()</span>
  <span class=n>end</span>

  <span class=k>def</span> <span class=nf>deinit</span><span class=p>()</span>
  <span class=n>end</span>
<span class=n>end</span>

<span class=n>neopool_driver</span> <span class=o>=</span> <span class=n>NeoPoolButtonMethods</span><span class=p>()</span>
<span class=n>tasmota</span><span class=o>.</span><span class=n>add_driver</span><span class=p>(</span><span class=n>neopool_driver</span><span class=p>)</span>
</code></pre></div> <p>To activate the new gui elements, go to WebGUI "Consoles" / "Berry Scripting console" and execute</p> <div class=highlight><pre><span></span><code><span class=n>load</span><span class=p>(</span><span class=s2>&quot;neopoolgui.be&quot;</span><span class=p>)</span>
</code></pre></div> <h3 id=esp32-make-the-scripts-persistent>ESP32: Make the scripts persistent<a class=headerlink href=#esp32-make-the-scripts-persistent title="Permanent link">~</a></h3> <p>If you want the extensions to be activated automatically every time you restart your ESP32, save the <code>load()</code> commands into the special file <code>autoexec.be</code>:</p> <h4 id=autoexecbe>autoexec.be<a class=headerlink href=#autoexecbe title="Permanent link">~</a></h4> <div class=highlight><pre><span></span><code><span class=n>load</span><span class=p>(</span><span class=s2>&quot;neopoolcmd.be&quot;</span><span class=p>)</span>
<span class=n>load</span><span class=p>(</span><span class=s2>&quot;neopoolgui.be&quot;</span><span class=p>)</span>
</code></pre></div> </article> </div> </div> <a href=# class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </a> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://discord.gg/Ks2Kzd4 target=_blank rel=noopener title=discord.gg class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 640 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M524.531 69.836a1.5 1.5 0 0 0-.764-.7A485.065 485.065 0 0 0 404.081 32.03a1.816 1.816 0 0 0-1.923.91 337.461 337.461 0 0 0-14.9 30.6 447.848 447.848 0 0 0-134.426 0 309.541 309.541 0 0 0-15.135-30.6 1.89 1.89 0 0 0-1.924-.91 483.689 483.689 0 0 0-119.688 37.107 1.712 1.712 0 0 0-.788.676C39.068 183.651 18.186 294.69 28.43 404.354a2.016 2.016 0 0 0 .765 1.375 487.666 487.666 0 0 0 146.825 74.189 1.9 1.9 0 0 0 2.063-.676A348.2 348.2 0 0 0 208.12 430.4a1.86 1.86 0 0 0-1.019-2.588 321.173 321.173 0 0 1-45.868-21.853 1.885 1.885 0 0 1-.185-3.126 251.047 251.047 0 0 0 9.109-7.137 1.819 1.819 0 0 1 1.9-.256c96.229 43.917 200.41 43.917 295.5 0a1.812 1.812 0 0 1 1.924.233 234.533 234.533 0 0 0 9.132 7.16 1.884 1.884 0 0 1-.162 3.126 301.407 301.407 0 0 1-45.89 21.83 1.875 1.875 0 0 0-1 2.611 391.055 391.055 0 0 0 30.014 48.815 1.864 1.864 0 0 0 2.063.7A486.048 486.048 0 0 0 610.7 405.729a1.882 1.882 0 0 0 .765-1.352c12.264-126.783-20.532-236.912-86.934-334.541ZM222.491 337.58c-28.972 0-52.844-26.587-52.844-59.239s23.409-59.241 52.844-59.241c29.665 0 53.306 26.82 52.843 59.239 0 32.654-23.41 59.241-52.843 59.241Zm195.38 0c-28.971 0-52.843-26.587-52.843-59.239s23.409-59.241 52.843-59.241c29.667 0 53.307 26.82 52.844 59.239 0 32.654-23.177 59.241-52.844 59.241Z"/></svg> </a> <a href=https://t.me/tasmota target=_blank rel=noopener title=t.me class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M248 8C111.033 8 0 119.033 0 256s111.033 248 248 248 248-111.033 248-248S384.967 8 248 8Zm114.952 168.66c-3.732 39.215-19.881 134.378-28.1 178.3-3.476 18.584-10.322 24.816-16.948 25.425-14.4 1.326-25.338-9.517-39.287-18.661-21.827-14.308-34.158-23.215-55.346-37.177-24.485-16.135-8.612-25 5.342-39.5 3.652-3.793 67.107-61.51 68.335-66.746.153-.655.3-3.1-1.154-4.384s-3.59-.849-5.135-.5q-3.283.746-104.608 69.142-14.845 10.194-26.894 9.934c-8.855-.191-25.888-5.006-38.551-9.123-15.531-5.048-27.875-7.717-26.8-16.291q.84-6.7 18.45-13.7 108.446-47.248 144.628-62.3c68.872-28.647 83.183-33.623 92.511-33.789 2.052-.034 6.639.474 9.61 2.885a10.452 10.452 0 0 1 3.53 6.716 43.765 43.765 0 0 1 .417 9.769Z"/></svg> </a> <a href=https://github.com/tasmota target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 480 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "..", "features": ["navigation.instant", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "content.action.edit"], "search": "../assets/javascripts/workers/search.db81ec45.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../assets/javascripts/bundle.4b2c34cd.min.js></script> <script src=https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js></script> <script src=../extra_javascript/tablesort.js></script> </body> </html>